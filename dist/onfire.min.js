(function(){var f = this;
function aa() {
}
function ba(a) {
  var b = typeof a;
  if ("object" == b) {
    if (a) {
      if (a instanceof Array) {
        return "array";
      }
      if (a instanceof Object) {
        return b;
      }
      var c = Object.prototype.toString.call(a);
      if ("[object Window]" == c) {
        return "object";
      }
      if ("[object Array]" == c || "number" == typeof a.length && "undefined" != typeof a.splice && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("splice")) {
        return "array";
      }
      if ("[object Function]" == c || "undefined" != typeof a.call && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("call")) {
        return "function";
      }
    } else {
      return "null";
    }
  } else {
    if ("function" == b && "undefined" == typeof a.call) {
      return "object";
    }
  }
  return b;
}
function h(a) {
  return "function" == ba(a);
}
function ca(a, b, c) {
  return a.call.apply(a.bind, arguments);
}
function da(a, b, c) {
  if (!a) {
    throw Error();
  }
  if (2 < arguments.length) {
    var d = Array.prototype.slice.call(arguments, 2);
    return function() {
      var c = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(c, d);
      return a.apply(b, c);
    };
  }
  return function() {
    return a.apply(b, arguments);
  };
}
function k(a, b, c) {
  k = Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? ca : da;
  return k.apply(null, arguments);
}
function ea(a, b) {
  var c = Array.prototype.slice.call(arguments, 1);
  return function() {
    var b = c.slice();
    b.push.apply(b, arguments);
    return a.apply(this, b);
  };
}
function m(a, b) {
  var c = a.split("."), d = f;
  c[0] in d || !d.execScript || d.execScript("var " + c[0]);
  for (var e;c.length && (e = c.shift());) {
    c.length || void 0 === b ? d[e] ? d = d[e] : d = d[e] = {} : d[e] = b;
  }
}
function fa(a, b) {
  function c() {
  }
  c.prototype = b.prototype;
  a.R = b.prototype;
  a.prototype = new c;
  a.prototype.constructor = a;
  a.P = function(a, c, l) {
    for (var g = Array(arguments.length - 2), p = 2;p < arguments.length;p++) {
      g[p - 2] = arguments[p];
    }
    return b.prototype[c].apply(a, g);
  };
}
;function n(a) {
  switch(typeof a) {
    case "function":
      return ga;
    case "object":
      return void 0 !== a.$id ? q : r;
  }
  switch(a) {
    case "string":
      return ha;
    case "number":
      return ia;
    case "boolean":
      return ja;
    default:
      return ka;
  }
}
var ha = 0, ia = 1, ja = 2, r = 3, q = 4, ga = 5, ka = -1;
var la = "undefined" !== typeof module && !!module.exports;
function u(a) {
  ma("info", arguments);
}
function na(a) {
  ma("warn", arguments);
}
function v(a) {
  ma("error", arguments);
}
function ma(a, b) {
  var c = Array.prototype.slice.call(b, 0);
  c.unshift("ONFIRE:");
  "function" === typeof console[a] ? console[a].apply(console, c) : console.log.apply(console, c);
}
;function oa(a, b) {
  this.c = a;
  this.f = b;
  this.b = 0;
  this.a = null;
}
function pa(a) {
  var b;
  0 < a.b ? (a.b--, b = a.a, a.a = b.next, b.next = null) : b = a.c();
  return b;
}
function qa(a, b) {
  a.f(b);
  100 > a.b && (a.b++, b.next = a.a, a.a = b);
}
;function ra(a) {
  var b = [], c = 0, d;
  for (d in a) {
    b[c++] = d;
  }
  return b;
}
;var sa = Array.prototype;
function ta(a) {
  return sa.concat.apply(sa, arguments);
}
;function ua() {
  this.b = this.a = null;
}
var wa = new oa(function() {
  return new va;
}, function(a) {
  a.reset();
});
function xa() {
  var a = ya, b = null;
  a.a && (b = a.a, a.a = a.a.next, a.a || (a.b = null), b.next = null);
  return b;
}
function va() {
  this.next = this.b = this.a = null;
}
va.prototype.reset = function() {
  this.next = this.b = this.a = null;
};
var w;
a: {
  var za = f.navigator;
  if (za) {
    var Aa = za.userAgent;
    if (Aa) {
      w = Aa;
      break a;
    }
  }
  w = "";
}
function x(a) {
  return -1 != w.indexOf(a);
}
;function Ba() {
  return x("Edge") || x("Trident") || x("MSIE");
}
;function Ca(a) {
  f.setTimeout(function() {
    throw a;
  }, 0);
}
var Da;
function Ea() {
  var a = f.MessageChannel;
  "undefined" === typeof a && "undefined" !== typeof window && window.postMessage && window.addEventListener && !x("Presto") && (a = function() {
    var a = document.createElement("IFRAME");
    a.style.display = "none";
    a.src = "";
    document.documentElement.appendChild(a);
    var b = a.contentWindow, a = b.document;
    a.open();
    a.write("");
    a.close();
    var c = "callImmediate" + Math.random(), d = "file:" == b.location.protocol ? "*" : b.location.protocol + "//" + b.location.host, a = k(function(a) {
      if (("*" == d || a.origin == d) && a.data == c) {
        this.port1.onmessage();
      }
    }, this);
    b.addEventListener("message", a, !1);
    this.port1 = {};
    this.port2 = {postMessage:function() {
      b.postMessage(c, d);
    }};
  });
  if ("undefined" !== typeof a && !Ba()) {
    var b = new a, c = {}, d = c;
    b.port1.onmessage = function() {
      if (void 0 !== c.next) {
        c = c.next;
        var a = c.L;
        c.L = null;
        a();
      }
    };
    return function(a) {
      d.next = {L:a};
      d = d.next;
      b.port2.postMessage(0);
    };
  }
  return "undefined" !== typeof document && "onreadystatechange" in document.createElement("SCRIPT") ? function(a) {
    var b = document.createElement("SCRIPT");
    b.onreadystatechange = function() {
      b.onreadystatechange = null;
      b.parentNode.removeChild(b);
      b = null;
      a();
      a = null;
    };
    document.documentElement.appendChild(b);
  } : function(a) {
    f.setTimeout(a, 0);
  };
}
;function y(a, b) {
  this.b = {};
  this.a = [];
  this.f = this.c = 0;
  var c = arguments.length;
  if (1 < c) {
    if (c % 2) {
      throw Error("Uneven number of arguments");
    }
    for (var d = 0;d < c;d += 2) {
      z(this, arguments[d], arguments[d + 1]);
    }
  } else {
    if (a) {
      if (a instanceof y) {
        c = a.w(), d = a.A();
      } else {
        var c = ra(a), e = [], l = 0;
        for (d in a) {
          e[l++] = a[d];
        }
        d = e;
      }
      for (e = 0;e < c.length;e++) {
        z(this, c[e], d[e]);
      }
    }
  }
}
y.prototype.A = function() {
  Fa(this);
  for (var a = [], b = 0;b < this.a.length;b++) {
    a.push(this.b[this.a[b]]);
  }
  return a;
};
y.prototype.w = function() {
  Fa(this);
  return this.a.concat();
};
y.prototype.clear = function() {
  this.b = {};
  this.f = this.c = this.a.length = 0;
};
function Fa(a) {
  if (a.c != a.a.length) {
    for (var b = 0, c = 0;b < a.a.length;) {
      var d = a.a[b];
      A(a.b, d) && (a.a[c++] = d);
      b++;
    }
    a.a.length = c;
  }
  if (a.c != a.a.length) {
    for (var e = {}, c = b = 0;b < a.a.length;) {
      d = a.a[b], A(e, d) || (a.a[c++] = d, e[d] = 1), b++;
    }
    a.a.length = c;
  }
}
function B(a, b) {
  return A(a.b, b) ? a.b[b] : void 0;
}
function z(a, b, c) {
  A(a.b, b) || (a.c++, a.a.push(b), a.f++);
  a.b[b] = c;
}
y.prototype.forEach = function(a, b) {
  for (var c = this.w(), d = 0;d < c.length;d++) {
    var e = c[d];
    a.call(b, B(this, e), e, this);
  }
};
y.prototype.clone = function() {
  return new y(this);
};
function A(a, b) {
  return Object.prototype.hasOwnProperty.call(a, b);
}
;function Ha(a, b) {
  C || Ia();
  D || (C(), D = !0);
  var c = ya, d = pa(wa);
  d.a = a;
  d.b = b;
  d.next = null;
  c.b ? c.b.next = d : c.a = d;
  c.b = d;
}
var C;
function Ia() {
  if (f.Promise && f.Promise.resolve) {
    var a = f.Promise.resolve();
    C = function() {
      a.then(Ja);
    };
  } else {
    C = function() {
      var a = Ja;
      !h(f.setImmediate) || f.Window && f.Window.prototype && f.Window.prototype.setImmediate == f.setImmediate ? (Da || (Da = Ea()), Da(a)) : f.setImmediate(a);
    };
  }
}
var D = !1, ya = new ua;
[].push(function() {
  D = !1;
  ya = new ua;
});
function Ja() {
  for (var a = null;a = xa();) {
    try {
      a.a.call(a.b);
    } catch (b) {
      Ca(b);
    }
    qa(wa, a);
  }
  D = !1;
}
;function E(a, b) {
  this.a = F;
  this.i = void 0;
  this.c = this.b = this.g = null;
  this.f = this.h = !1;
  if (a == Ka) {
    G(this, H, b);
  } else {
    try {
      var c = this;
      a.call(b, function(a) {
        G(c, H, a);
      }, function(a) {
        try {
          if (a instanceof Error) {
            throw a;
          }
          throw Error("Promise rejected.");
        } catch (b) {
        }
        G(c, J, a);
      });
    } catch (d) {
      G(this, J, d);
    }
  }
}
var F = 0, H = 2, J = 3;
function La() {
  this.next = this.c = this.b = this.f = this.a = null;
  this.g = !1;
}
La.prototype.reset = function() {
  this.c = this.b = this.f = this.a = null;
  this.g = !1;
};
var Na = new oa(function() {
  return new La;
}, function(a) {
  a.reset();
});
function Oa(a, b, c) {
  var d = pa(Na);
  d.f = a;
  d.b = b;
  d.c = c;
  return d;
}
function Ka() {
}
function Pa(a) {
  return new E(function(b, c) {
    c(a);
  });
}
function Qa(a) {
  return new E(function(b, c) {
    var d = a.length, e = [];
    if (d) {
      for (var l = function(a, c) {
        d--;
        e[a] = c;
        0 == d && b(e);
      }, g = function(a) {
        c(a);
      }, p = 0, t;t = a[p];p++) {
        Ra(t, ea(l, p), g);
      }
    } else {
      b(e);
    }
  });
}
E.prototype.then = function(a, b, c) {
  return Sa(this, h(a) ? a : null, h(b) ? b : null, c);
};
E.prototype.then = E.prototype.then;
E.prototype.$goog_Thenable = !0;
function Ra(a, b, c, d) {
  a instanceof E ? Ta(a, Oa(b || aa, c || null, d)) : a.then(b, c, d);
}
function Ta(a, b) {
  a.b || a.a != H && a.a != J || Ua(a);
  a.c ? a.c.next = b : a.b = b;
  a.c = b;
}
function Sa(a, b, c, d) {
  var e = Oa(null, null, null);
  e.a = new E(function(a, g) {
    e.f = b ? function(c) {
      try {
        var e = b.call(d, c);
        a(e);
      } catch (I) {
        g(I);
      }
    } : a;
    e.b = c ? function(b) {
      try {
        var e = c.call(d, b);
        a(e);
      } catch (I) {
        g(I);
      }
    } : g;
  });
  e.a.g = a;
  Ta(a, e);
  return e.a;
}
E.prototype.j = function(a) {
  this.a = F;
  G(this, H, a);
};
E.prototype.l = function(a) {
  this.a = F;
  G(this, J, a);
};
function G(a, b, c) {
  if (a.a == F) {
    if (a == c) {
      b = J, c = new TypeError("Promise cannot resolve to itself");
    } else {
      var d;
      if (c) {
        try {
          d = !!c.$goog_Thenable;
        } catch (e) {
          d = !1;
        }
      } else {
        d = !1;
      }
      if (d) {
        a.a = 1;
        Ra(c, a.j, a.l, a);
        return;
      }
      d = typeof c;
      if ("object" == d && null != c || "function" == d) {
        try {
          var l = c.then;
          if (h(l)) {
            Va(a, c, l);
            return;
          }
        } catch (g) {
          b = J, c = g;
        }
      }
    }
    a.i = c;
    a.a = b;
    a.g = null;
    Ua(a);
    b != J || Wa(a, c);
  }
}
function Va(a, b, c) {
  function d(b) {
    l || (l = !0, a.l(b));
  }
  function e(b) {
    l || (l = !0, a.j(b));
  }
  a.a = 1;
  var l = !1;
  try {
    c.call(b, e, d);
  } catch (g) {
    d(g);
  }
}
function Ua(a) {
  a.h || (a.h = !0, Ha(a.o, a));
}
function Xa(a) {
  var b = null;
  a.b && (b = a.b, a.b = b.next, b.next = null);
  a.b || (a.c = null);
  return b;
}
E.prototype.o = function() {
  for (var a = null;a = Xa(this);) {
    var b = this.a, c = this.i;
    if (b == J && a.b && !a.g) {
      for (var d = void 0, d = this;d && d.f;d = d.g) {
        d.f = !1;
      }
    }
    if (a.a) {
      a.a.g = null, Ya(a, b, c);
    } else {
      try {
        a.g ? a.f.call(a.c) : Ya(a, b, c);
      } catch (e) {
        Za.call(null, e);
      }
    }
    qa(Na, a);
  }
  this.h = !1;
};
function Ya(a, b, c) {
  b == H ? a.f.call(a.c, c) : a.b && a.b.call(a.c, c);
}
function Wa(a, b) {
  a.f = !0;
  Ha(function() {
    a.f && Za.call(null, b);
  });
}
var Za = Ca;
var K = "undefined" !== typeof Promise;
function L(a) {
  return K ? new Promise(a) : new E(a);
}
function M(a) {
  return K ? Promise.resolve(a) : a instanceof E ? a : new E(Ka, a);
}
function N(a) {
  return K ? Promise.all(a) : Qa(a);
}
;function $a(a, b) {
  return L(function(c, d) {
    if (void 0 !== b) {
      var e = a.push(b, function(a) {
        a ? d(a) : c(e);
      })
    } else {
      c(a.push());
    }
  });
}
function ab(a, b) {
  return L(function(c, d) {
    a.set(b, function(a) {
      a ? d(a) : c();
    });
  });
}
function bb(a, b) {
  return L(function(c, d) {
    a.update(b, function(a) {
      a ? d(a) : c();
    });
  });
}
function cb(a, b) {
  return L(function(c, d) {
    a.transaction(b, function(a, b, g) {
      a ? d(a) : c({isCommitted:b, snapshot:g});
    }, !1);
  });
}
function db(a) {
  return L(function(b, c) {
    a.remove(function(a) {
      a ? c(a) : b();
    });
  });
}
function eb(a, b) {
  return L(function(c, d) {
    a.once(b, function(a) {
      c(a);
    }, function(a) {
      d(a);
    });
  });
}
la && require("firebase");
function O() {
  this.a = [];
}
O.b = function() {
  return O.a ? O.a : O.a = new O;
};
function P(a, b, c, d) {
  a: {
    var e = O.b();
    if (null === a) {
      b = M([null]);
    } else {
      u("LOCAL_TRIGGER_GENERATED " + b.toUpperCase() + " at " + a.a());
      var l = [];
      a = a.a();
      for (var g = 0;g < e.a.length;g++) {
        var p = e.a[g][0], t = e.a[g][1], I = e.a[g][2], Ga = e.a[g][3];
        if (t === b) {
          var Y = a.match(p);
          if (Y) {
            u("LOCAL_TRIGGER_MATCHED at " + p.toString() + " on " + t.toUpperCase() + " for " + Ga.id());
            Y.push(c);
            "value" === b && Y.push(d);
            try {
              var sb = I.apply(Ga, Y.slice(1));
            } catch (Ma) {
              u("LOCAL_TRIGGER_FAILED at " + p.toString() + " on " + t.toUpperCase(), Ma);
              b = Ma;
              b = K ? Promise.reject(b) : Pa(b);
              break a;
            }
            l.push(sb);
          }
        }
      }
      b = N(l);
    }
  }
  return b;
}
function fb(a, b) {
  return P(a, "child_added", b);
}
;var gb = x("Opera") || x("OPR"), hb = Ba(), ib = x("Gecko") && !(-1 != w.toLowerCase().indexOf("webkit") && !x("Edge")) && !(x("Trident") || x("MSIE")) && !x("Edge"), jb = -1 != w.toLowerCase().indexOf("webkit") && !x("Edge");
function kb() {
  var a = w;
  if (ib) {
    return /rv\:([^\);]+)(\)|;)/.exec(a);
  }
  if (hb && x("Edge")) {
    return /Edge\/([\d\.]+)/.exec(a);
  }
  if (hb) {
    return /\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);
  }
  if (jb) {
    return /WebKit\/(\S+)/.exec(a);
  }
}
(function() {
  if (gb && f.opera) {
    var a = f.opera.version;
    return h(a) ? a() : a;
  }
  var a = "", b = kb();
  b && (a = b ? b[1] : "");
  return hb && !x("Edge") && (b = (b = f.document) ? b.documentMode : void 0, b > parseFloat(a)) ? String(b) : a;
})();
var lb = /^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
function mb(a) {
  if (nb) {
    nb = !1;
    var b = f.location;
    if (b) {
      var c = b.href;
      if (c && (c = (c = mb(c)[3] || null) ? decodeURI(c) : c) && c != b.hostname) {
        throw nb = !0, Error();
      }
    }
  }
  return a.match(lb);
}
var nb = jb;
function ob(a, b) {
  for (var c = a.split("&"), d = 0;d < c.length;d++) {
    var e = c[d].indexOf("="), l = null, g = null;
    0 <= e ? (l = c[d].substring(0, e), g = c[d].substring(e + 1)) : l = c[d];
    b(l, g ? decodeURIComponent(g.replace(/\+/g, " ")) : "");
  }
}
;function Q(a, b) {
  this.f = this.j = this.b = "";
  this.i = null;
  this.h = this.c = "";
  this.a = !1;
  var c;
  a instanceof Q ? (this.a = void 0 !== b ? b : a.a, pb(this, a.b), this.j = a.j, this.f = a.f, qb(this, a.i), this.c = a.c, rb(this, a.g.clone()), this.h = a.h) : a && (c = mb(String(a))) ? (this.a = !!b, pb(this, c[1] || "", !0), this.j = R(c[2] || ""), this.f = R(c[3] || "", !0), qb(this, c[4]), this.c = R(c[5] || "", !0), rb(this, c[6] || "", !0), this.h = R(c[7] || "")) : (this.a = !!b, this.g = new S(null, 0, this.a));
}
Q.prototype.toString = function() {
  var a = [], b = this.b;
  b && a.push(T(b, tb, !0), ":");
  if (b = this.f) {
    a.push("//");
    var c = this.j;
    c && a.push(T(c, tb, !0), "@");
    a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g, "%$1"));
    b = this.i;
    null != b && a.push(":", String(b));
  }
  if (b = this.c) {
    this.f && "/" != b.charAt(0) && a.push("/"), a.push(T(b, "/" == b.charAt(0) ? ub : vb, !0));
  }
  (b = this.g.toString()) && a.push("?", b);
  (b = this.h) && a.push("#", T(b, wb));
  return a.join("");
};
Q.prototype.clone = function() {
  return new Q(this);
};
function pb(a, b, c) {
  a.b = c ? R(b, !0) : b;
  a.b && (a.b = a.b.replace(/:$/, ""));
}
function qb(a, b) {
  if (b) {
    b = Number(b);
    if (isNaN(b) || 0 > b) {
      throw Error("Bad port number " + b);
    }
    a.i = b;
  } else {
    a.i = null;
  }
}
function rb(a, b, c) {
  b instanceof S ? (a.g = b, xb(a.g, a.a)) : (c || (b = T(b, yb)), a.g = new S(b, 0, a.a));
}
function R(a, b) {
  return a ? b ? decodeURI(a.replace(/%25/g, "%2525")) : decodeURIComponent(a) : "";
}
function T(a, b, c) {
  return "string" == typeof a ? (a = encodeURI(a).replace(b, zb), c && (a = a.replace(/%25([0-9a-fA-F]{2})/g, "%$1")), a) : null;
}
function zb(a) {
  a = a.charCodeAt(0);
  return "%" + (a >> 4 & 15).toString(16) + (a & 15).toString(16);
}
var tb = /[#\/\?@]/g, vb = /[\#\?:]/g, ub = /[\#\?]/g, yb = /[\#\?@]/g, wb = /#/g;
function S(a, b, c) {
  this.c = this.a = null;
  this.b = a || null;
  this.f = !!c;
}
function U(a) {
  a.a || (a.a = new y, a.c = 0, a.b && ob(a.b, function(b, c) {
    var d = decodeURIComponent(b.replace(/\+/g, " "));
    U(a);
    a.b = null;
    var d = V(a, d), e = B(a.a, d);
    e || z(a.a, d, e = []);
    e.push(c);
    a.c++;
  }));
}
function Ab(a, b) {
  U(a);
  b = V(a, b);
  if (A(a.a.b, b)) {
    a.b = null;
    a.c -= B(a.a, b).length;
    var c = a.a;
    A(c.b, b) && (delete c.b[b], c.c--, c.f++, c.a.length > 2 * c.c && Fa(c));
  }
}
S.prototype.clear = function() {
  this.a = this.b = null;
  this.c = 0;
};
S.prototype.w = function() {
  U(this);
  for (var a = this.a.A(), b = this.a.w(), c = [], d = 0;d < b.length;d++) {
    for (var e = a[d], l = 0;l < e.length;l++) {
      c.push(b[d]);
    }
  }
  return c;
};
S.prototype.A = function(a) {
  U(this);
  var b = [];
  if ("string" == typeof a) {
    var c = a;
    U(this);
    c = V(this, c);
    A(this.a.b, c) && (b = ta(b, B(this.a, V(this, a))));
  } else {
    for (a = this.a.A(), c = 0;c < a.length;c++) {
      b = ta(b, a[c]);
    }
  }
  return b;
};
S.prototype.toString = function() {
  if (this.b) {
    return this.b;
  }
  if (!this.a) {
    return "";
  }
  for (var a = [], b = this.a.w(), c = 0;c < b.length;c++) {
    for (var d = b[c], e = encodeURIComponent(String(d)), d = this.A(d), l = 0;l < d.length;l++) {
      var g = e;
      "" !== d[l] && (g += "=" + encodeURIComponent(String(d[l])));
      a.push(g);
    }
  }
  return this.b = a.join("&");
};
S.prototype.clone = function() {
  var a = new S;
  a.b = this.b;
  this.a && (a.a = this.a.clone(), a.c = this.c);
  return a;
};
function V(a, b) {
  var c = String(b);
  a.f && (c = c.toLowerCase());
  return c;
}
function xb(a, b) {
  b && !a.f && (U(a), a.b = null, a.a.forEach(function(a, b) {
    var e = b.toLowerCase();
    if (b != e && (Ab(this, b), Ab(this, e), 0 < a.length)) {
      this.b = null;
      var l = this.a, e = V(this, e), g;
      g = a.length;
      if (0 < g) {
        for (var p = Array(g), t = 0;t < g;t++) {
          p[t] = a[t];
        }
        g = p;
      } else {
        g = [];
      }
      z(l, e, g);
      this.c += a.length;
    }
  }, a));
  a.f = b;
}
;function W(a) {
  this.b = a;
}
m("onfire.Ref", W);
W.prototype.f = function(a, b) {
  var c = this.b.child(a);
  return new W(null != b ? c.child(b) : c);
};
W.prototype.child = W.prototype.f;
W.prototype.G = function() {
  return new W(this.b.root());
};
W.prototype.root = W.prototype.G;
W.prototype.push = function(a) {
  u("PUSH " + this.a() + " :", a);
  var b = this;
  return $a(this.b, a).then(function(c) {
    u("PUSH (Success) " + b.a() + " :", a);
    return new W(c);
  }, function(c) {
    v("PUSH (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
W.prototype.push = W.prototype.push;
W.prototype.i = function() {
  return this.b.push().key();
};
W.prototype.generateId = W.prototype.i;
W.prototype.H = function(a) {
  u("SET " + this.a() + " :", a);
  var b = this;
  return ab(this.b, a).then(function() {
    u("SET (Success) " + b.a() + " :", a);
    return null;
  }, function(c) {
    v("SET (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
W.prototype.set = W.prototype.H;
W.prototype.v = function(a) {
  u("UPDATE " + this.a() + " :", a);
  var b = this;
  return bb(this.b, a).then(function() {
    u("UPDATE (Success) " + b.a() + " :", a);
    return null;
  }, function(c) {
    v("UPDATE (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
W.prototype.update = W.prototype.v;
W.prototype.u = function(a) {
  u("TRANSACTION at " + this.a());
  var b = this;
  return cb(this.b, a).then(function(a) {
    u("TRANSACTION " + (a.isCommitted ? "Committed" : "Not Committed") + " at " + b.a() + " :", a.snapshot.val());
    return a;
  }, function(a) {
    v("TRANSACTION Failed at " + b.a());
    throw a;
  });
};
W.prototype.transaction = W.prototype.u;
W.prototype.F = function() {
  u("REMOVE " + this.a());
  var a = this;
  return db(this.b).then(function() {
    u("REMOVE (Success) " + a.a());
    return null;
  }, function(b) {
    v("REMOVE (Failure) " + a.a(), b);
    throw b;
  });
};
W.prototype.remove = W.prototype.F;
W.prototype.s = function(a) {
  u("ONCE " + a.toUpperCase() + " " + this.a());
  var b = this;
  return eb(this.b, a).then(function(c) {
    u("ONCE " + a.toUpperCase() + " (Success) " + b.a(), c.val());
    return c;
  }, function(c) {
    v("ONCE " + a.toUpperCase() + " (Failure) " + b.a(), c);
    throw c;
  });
};
W.prototype.once = W.prototype.s;
W.prototype.K = function() {
  return this.s("value").then(function(a) {
    return a.val();
  });
};
W.prototype.onceValue = W.prototype.K;
W.prototype.o = function(a, b, c, d) {
  var e = this;
  return this.b.on(a, function(c, g) {
    u(a.toUpperCase() + " at " + e.a(), c.val());
    b.call(d, c, g);
  }, function(b) {
    v(a.toUpperCase() + " CANCELLED at " + e.a(), b);
    "function" === typeof c && c.call(d, b);
  });
};
W.prototype.on = W.prototype.o;
W.prototype.h = function(a, b, c) {
  this.b.off(a, b, c);
};
W.prototype.off = W.prototype.h;
W.prototype.j = function(a, b, c) {
  return this.o("value", function(b) {
    a.call(c, b.val());
  }, b, c);
};
W.prototype.onValue = W.prototype.j;
W.prototype.C = function(a, b) {
  this.h("value", a, b);
};
W.prototype.offValue = W.prototype.C;
W.prototype.D = function() {
  return this.b;
};
W.prototype.ref = W.prototype.D;
W.prototype.g = function() {
  var a = this.b.parent();
  return a ? new W(a) : null;
};
W.prototype.parent = W.prototype.g;
W.prototype.l = function() {
  return this.b.key();
};
W.prototype.key = W.prototype.l;
W.prototype.a = function() {
  var a;
  if (!(a = this.c)) {
    a = decodeURIComponent;
    var b = this.b.toString(), b = (b instanceof Q ? b.clone() : new Q(b, void 0)).c;
    a = this.c = a(b) || "/";
  }
  return a;
};
W.prototype.path = W.prototype.a;
function X(a) {
  if (!(a instanceof W)) {
    throw Error("ref argument must be an onfire.Ref instance");
  }
  this.a = a;
  this.I = {};
  this.B = !1;
  this.h = 0;
  this.u = null;
  this.v = [];
  this.m = Bb(this);
}
m("onfire.model.Model", X);
X.prototype.J = function() {
  u("DISPOSE  " + this.a.a() + " ...");
  this.o();
  delete this.m;
  this.a.h(void 0, void 0, this);
  for (var a = 0;a < this.v.length;a++) {
    this.v[a].J();
  }
  u("DISPOSED " + this.a.a());
};
X.prototype.dispose = X.prototype.J;
function Cb(a, b) {
  a.u = b;
  var c = [], d;
  for (d in a.u) {
    var e;
    switch(n(a.u[d])) {
      case ha:
      ;
      case ia:
      ;
      case ja:
        break;
      case r:
      ;
      case q:
        e = a[d + "Ctor_"];
        a[d + "Inst_"] = new e(a.a.f(d));
        c.push(a[d + "Inst_"].m);
        a.v.push(a[d + "Inst_"]);
        break;
      default:
        throw new TypeError("Invalid property type for " + d);;
    }
  }
  a.m = a.m.then(function() {
    return N(c);
  }).then(function() {
    return a;
  });
}
function Bb(a) {
  return L(function(b) {
    var c = !1;
    a.a.j(function(d) {
      a.g = d;
      a.h = ra(d).length;
      c || (b(a), c = !0);
    }, void 0);
  });
}
X.prototype.O = function() {
  return this.m;
};
X.prototype.whenLoaded = X.prototype.O;
X.prototype.o = function() {
  return this.a.l();
};
X.prototype.key = X.prototype.o;
X.prototype.N = function() {
  return !!this.g;
};
X.prototype.exists = X.prototype.N;
X.prototype.f = function(a) {
  return this.c(a) || this.i(a);
};
X.prototype.get = X.prototype.f;
X.prototype.i = function(a) {
  return this.g ? this.g[a] : null;
};
X.prototype.getBasicValue = X.prototype.i;
X.prototype.c = function(a) {
  return this[a + "Inst_"];
};
X.prototype.getModel = X.prototype.c;
X.prototype.s = function(a, b) {
  this.I[a] = b;
  this.B = !0;
  return this;
};
X.prototype.set = X.prototype.s;
X.prototype.C = function() {
  return this.B ? Db(this, this.I).then(function(a) {
    a.I = {};
    a.B = !1;
    return a;
  }) : M(this);
};
X.prototype.save = X.prototype.C;
X.prototype.D = function() {
  return this.B;
};
X.prototype.hasChanges = X.prototype.D;
function Db(a, b) {
  var c = a.h, d = {}, e;
  for (e in b) {
    d[e] = a.f(e);
  }
  return a.a.v(b).then(function() {
    var c = [];
    for (e in b) {
      if (d[e] !== b[e]) {
        var g = P(a.a.f(e), "value", d[e], b[e]);
        c.push(g);
      }
    }
    return N(c);
  }).then(function() {
    if (0 < c && 0 === a.h) {
      u("REMOVED " + a.a.a());
      var b = a.a.g(), d = a.o();
      return P(b, "child_removed", a, d);
    }
    if (0 === c && 0 < a.h) {
      return u("CREATED " + a.a.a()), fb(a.a.g(), a);
    }
  }).then(function() {
    return a;
  });
}
function Eb(a, b) {
  return a.a.u(function(a) {
    if (null === a) {
      return b;
    }
  }).then(function(b) {
    return b.isCommitted ? (u("CREATED " + a.a.a()), fb(a.a.g(), a).then(function() {
      return b;
    })) : b;
  });
}
;function Z(a, b) {
  X.call(this, a);
  this.b = b;
}
fa(Z, X);
m("onfire.model.Collection", Z);
Z.prototype.f = function(a) {
  return this.b ? this.c(a) : this.i(a);
};
Z.prototype.get = Z.prototype.f;
Z.prototype.c = function(a) {
  if (this.b) {
    if (this.l(a)) {
      return new this.b(this.a.f(a));
    }
    throw Error("No such key in the collection.");
  }
  throw Error("Cannot create a model for a primitive value");
};
Z.prototype.getModel = Z.prototype.c;
Z.prototype.j = function(a) {
  return this.c(a).m;
};
Z.prototype.fetch = Z.prototype.j;
Z.prototype.G = function(a) {
  if (!this.b) {
    throw Error(".create() is for creating models, not primitive values");
  }
  var b = this.a.i(), b = (new this.b(this.a.f(b))).m;
  a && (b = b.then(function(b) {
    return Db(b, a);
  }));
  return b;
};
Z.prototype.create = Z.prototype.G;
Z.prototype.K = function(a, b) {
  if (!this.b) {
    throw Error(".fetchOrCreate() is for fetching/creating models, not primitive values");
  }
  return (new this.b(this.a.f(a))).m.then(function(a) {
    return b ? Eb(a, b).then(function() {
      return a;
    }) : a;
  });
};
Z.prototype.fetchOrCreate = Z.prototype.K;
Z.prototype.M = function(a) {
  if (!this.l(a)) {
    return M(null);
  }
  var b, c = this;
  return (this.b ? this.j(a) : M(this.i(a))).then(function(a) {
    b = a;
  }).then(function() {
    c.s(a, null);
    return c.C();
  }).then(function() {
    return P(c.a, "child_removed", b, a);
  }).then(function() {
    b.J();
  });
};
Z.prototype.remove = Z.prototype.M;
Z.prototype.forEach = function(a) {
  var b = [], c;
  for (c in this.g) {
    var d = this.b ? this.j(c) : M(this.i(c));
    d.then(function(b) {
      return a.call(null, b, c);
    });
    b.push(d);
  }
  return N(b);
};
Z.prototype.forEach = Z.prototype.forEach;
Z.prototype.F = function() {
  return this.h;
};
Z.prototype.count = Z.prototype.F;
Z.prototype.l = function(a) {
  return a in this.g;
};
Z.prototype.containsKey = Z.prototype.l;
Z.prototype.H = function() {
  return ra(this.g);
};
Z.prototype.keys = Z.prototype.H;
function Fb(a) {
  switch(typeof a) {
    case "function":
      return a;
    case "object":
      break;
    default:
      throw Error("Invalid schema - it must be an object or a constructor!");;
  }
  return n(a) === q ? Gb(a) : Hb(a);
}
function Hb(a) {
  function b(b) {
    X.call(this, b);
    Cb(this, a);
  }
  fa(b, X);
  Ib(b, a);
  return b;
}
function Gb(a) {
  function b(a) {
    Z.call(this, a, c);
  }
  a = a.$id;
  var c;
  switch(n(a)) {
    case ga:
      c = a;
      break;
    case r:
    ;
    case q:
      c = Hb(a);
  }
  fa(b, Z);
  return b;
}
function Ib(a, b) {
  for (var c in b) {
    var d = b[c];
    switch(n(d)) {
      case ha:
      ;
      case ia:
      ;
      case ja:
        void 0 === a.prototype[c] ? a.prototype[c] = Jb(c) : na(c + " clashes with a built-in property or method. Use the generic .get(" + c + ") / .set(" + c + ", value) methods to access this property.");
        break;
      case ga:
      ;
      case r:
      ;
      case q:
        a.prototype[c + "Ctor_"] = Fb(d);
        void 0 === a.prototype[c] ? a.prototype[c] = Kb(c) : na(c + " clashes with a built-in property or method. Use the generic .getModel(" + c + ") method to access this property.");
        break;
      default:
        throw new TypeError("Invalid property type for " + c);;
    }
  }
}
function Jb(a) {
  return function(b) {
    return 0 === arguments.length ? this.f(a) : this.s(a, b);
  };
}
function Kb(a) {
  return function() {
    return this.f(a);
  };
}
;m("onfire.defineModel", Fb);
la && (module.exports = f.onfire);
})();//# sourceMappingURL=./onfire.min.js.map
