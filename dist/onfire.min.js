(function(){var f = this;
function aa() {
}
function ba(a) {
  var b = typeof a;
  if ("object" == b) {
    if (a) {
      if (a instanceof Array) {
        return "array";
      }
      if (a instanceof Object) {
        return b;
      }
      var c = Object.prototype.toString.call(a);
      if ("[object Window]" == c) {
        return "object";
      }
      if ("[object Array]" == c || "number" == typeof a.length && "undefined" != typeof a.splice && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("splice")) {
        return "array";
      }
      if ("[object Function]" == c || "undefined" != typeof a.call && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("call")) {
        return "function";
      }
    } else {
      return "null";
    }
  } else {
    if ("function" == b && "undefined" == typeof a.call) {
      return "object";
    }
  }
  return b;
}
function h(a) {
  return "function" == ba(a);
}
function ca(a, b, c) {
  return a.call.apply(a.bind, arguments);
}
function da(a, b, c) {
  if (!a) {
    throw Error();
  }
  if (2 < arguments.length) {
    var d = Array.prototype.slice.call(arguments, 2);
    return function() {
      var c = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(c, d);
      return a.apply(b, c);
    };
  }
  return function() {
    return a.apply(b, arguments);
  };
}
function l(a, b, c) {
  l = Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? ca : da;
  return l.apply(null, arguments);
}
function ea(a, b) {
  var c = Array.prototype.slice.call(arguments, 1);
  return function() {
    var b = c.slice();
    b.push.apply(b, arguments);
    return a.apply(this, b);
  };
}
function m(a, b) {
  var c = a.split("."), d = f;
  c[0] in d || !d.execScript || d.execScript("var " + c[0]);
  for (var e;c.length && (e = c.shift());) {
    c.length || void 0 === b ? d[e] ? d = d[e] : d = d[e] = {} : d[e] = b;
  }
}
function n(a, b) {
  function c() {
  }
  c.prototype = b.prototype;
  a.N = b.prototype;
  a.prototype = new c;
  a.prototype.constructor = a;
  a.M = function(a, c, k) {
    for (var g = Array(arguments.length - 2), q = 2;q < arguments.length;q++) {
      g[q - 2] = arguments[q];
    }
    return b.prototype[c].apply(a, g);
  };
}
;var fa = "undefined" !== typeof module && !!module.exports;
function p(a) {
  r("info", arguments);
}
function ga(a) {
  r("warn", arguments);
}
function u(a) {
  r("error", arguments);
}
function r(a, b) {
  var c = Array.prototype.slice.call(b, 0);
  c.unshift("ONFIRE:");
  "function" === typeof console[a] ? console[a].apply(console, c) : console.log.apply(console, c);
}
;function ha(a, b) {
  this.c = a;
  this.f = b;
  this.b = 0;
  this.a = null;
}
function ia(a) {
  var b;
  0 < a.b ? (a.b--, b = a.a, a.a = b.next, b.next = null) : b = a.c();
  return b;
}
function ja(a, b) {
  a.f(b);
  100 > a.b && (a.b++, b.next = a.a, a.a = b);
}
;function v(a) {
  var b = [], c = 0, d;
  for (d in a) {
    b[c++] = d;
  }
  return b;
}
;var ka = Array.prototype;
function la(a) {
  return ka.concat.apply(ka, arguments);
}
;function ma() {
  this.b = this.a = null;
}
var oa = new ha(function() {
  return new na;
}, function(a) {
  a.reset();
});
function pa() {
  var a = w, b = null;
  a.a && (b = a.a, a.a = a.a.next, a.a || (a.b = null), b.next = null);
  return b;
}
function na() {
  this.next = this.b = this.a = null;
}
na.prototype.reset = function() {
  this.next = this.b = this.a = null;
};
var x;
a: {
  var qa = f.navigator;
  if (qa) {
    var ra = qa.userAgent;
    if (ra) {
      x = ra;
      break a;
    }
  }
  x = "";
}
function y(a) {
  return -1 != x.indexOf(a);
}
;function sa() {
  return y("Edge") || y("Trident") || y("MSIE");
}
;function ta(a) {
  f.setTimeout(function() {
    throw a;
  }, 0);
}
var ua;
function va() {
  var a = f.MessageChannel;
  "undefined" === typeof a && "undefined" !== typeof window && window.postMessage && window.addEventListener && !y("Presto") && (a = function() {
    var a = document.createElement("IFRAME");
    a.style.display = "none";
    a.src = "";
    document.documentElement.appendChild(a);
    var b = a.contentWindow, a = b.document;
    a.open();
    a.write("");
    a.close();
    var c = "callImmediate" + Math.random(), d = "file:" == b.location.protocol ? "*" : b.location.protocol + "//" + b.location.host, a = l(function(a) {
      if (("*" == d || a.origin == d) && a.data == c) {
        this.port1.onmessage();
      }
    }, this);
    b.addEventListener("message", a, !1);
    this.port1 = {};
    this.port2 = {postMessage:function() {
      b.postMessage(c, d);
    }};
  });
  if ("undefined" !== typeof a && !sa()) {
    var b = new a, c = {}, d = c;
    b.port1.onmessage = function() {
      if (void 0 !== c.next) {
        c = c.next;
        var a = c.K;
        c.K = null;
        a();
      }
    };
    return function(a) {
      d.next = {K:a};
      d = d.next;
      b.port2.postMessage(0);
    };
  }
  return "undefined" !== typeof document && "onreadystatechange" in document.createElement("SCRIPT") ? function(a) {
    var b = document.createElement("SCRIPT");
    b.onreadystatechange = function() {
      b.onreadystatechange = null;
      b.parentNode.removeChild(b);
      b = null;
      a();
      a = null;
    };
    document.documentElement.appendChild(b);
  } : function(a) {
    f.setTimeout(a, 0);
  };
}
;function z(a, b) {
  this.b = {};
  this.a = [];
  this.f = this.c = 0;
  var c = arguments.length;
  if (1 < c) {
    if (c % 2) {
      throw Error("Uneven number of arguments");
    }
    for (var d = 0;d < c;d += 2) {
      A(this, arguments[d], arguments[d + 1]);
    }
  } else {
    if (a) {
      if (a instanceof z) {
        c = a.o(), d = a.s();
      } else {
        var c = v(a), e = [], k = 0;
        for (d in a) {
          e[k++] = a[d];
        }
        d = e;
      }
      for (e = 0;e < c.length;e++) {
        A(this, c[e], d[e]);
      }
    }
  }
}
z.prototype.s = function() {
  wa(this);
  for (var a = [], b = 0;b < this.a.length;b++) {
    a.push(this.b[this.a[b]]);
  }
  return a;
};
z.prototype.o = function() {
  wa(this);
  return this.a.concat();
};
z.prototype.clear = function() {
  this.b = {};
  this.f = this.c = this.a.length = 0;
};
function wa(a) {
  if (a.c != a.a.length) {
    for (var b = 0, c = 0;b < a.a.length;) {
      var d = a.a[b];
      B(a.b, d) && (a.a[c++] = d);
      b++;
    }
    a.a.length = c;
  }
  if (a.c != a.a.length) {
    for (var e = {}, c = b = 0;b < a.a.length;) {
      d = a.a[b], B(e, d) || (a.a[c++] = d, e[d] = 1), b++;
    }
    a.a.length = c;
  }
}
function C(a, b) {
  return B(a.b, b) ? a.b[b] : void 0;
}
function A(a, b, c) {
  B(a.b, b) || (a.c++, a.a.push(b), a.f++);
  a.b[b] = c;
}
z.prototype.forEach = function(a, b) {
  for (var c = this.o(), d = 0;d < c.length;d++) {
    var e = c[d];
    a.call(b, C(this, e), e, this);
  }
};
z.prototype.clone = function() {
  return new z(this);
};
function B(a, b) {
  return Object.prototype.hasOwnProperty.call(a, b);
}
;function xa(a, b) {
  D || ya();
  E || (D(), E = !0);
  var c = w, d = ia(oa);
  d.a = a;
  d.b = b;
  d.next = null;
  c.b ? c.b.next = d : c.a = d;
  c.b = d;
}
var D;
function ya() {
  if (f.Promise && f.Promise.resolve) {
    var a = f.Promise.resolve();
    D = function() {
      a.then(za);
    };
  } else {
    D = function() {
      var a = za;
      !h(f.setImmediate) || f.Window && f.Window.prototype && f.Window.prototype.setImmediate == f.setImmediate ? (ua || (ua = va()), ua(a)) : f.setImmediate(a);
    };
  }
}
var E = !1, w = new ma;
[].push(function() {
  E = !1;
  w = new ma;
});
function za() {
  for (var a = null;a = pa();) {
    try {
      a.a.call(a.b);
    } catch (b) {
      ta(b);
    }
    ja(oa, a);
  }
  E = !1;
}
;function F(a, b) {
  this.a = G;
  this.i = void 0;
  this.c = this.b = this.g = null;
  this.f = this.h = !1;
  if (a == Aa) {
    I(this, J, b);
  } else {
    try {
      var c = this;
      a.call(b, function(a) {
        I(c, J, a);
      }, function(a) {
        try {
          if (a instanceof Error) {
            throw a;
          }
          throw Error("Promise rejected.");
        } catch (b) {
        }
        I(c, K, a);
      });
    } catch (d) {
      I(this, K, d);
    }
  }
}
var G = 0, J = 2, K = 3;
function Ba() {
  this.next = this.c = this.b = this.f = this.a = null;
  this.g = !1;
}
Ba.prototype.reset = function() {
  this.c = this.b = this.f = this.a = null;
  this.g = !1;
};
var Ca = new ha(function() {
  return new Ba;
}, function(a) {
  a.reset();
});
function Ea(a, b, c) {
  var d = ia(Ca);
  d.f = a;
  d.b = b;
  d.c = c;
  return d;
}
function Aa() {
}
function Fa(a) {
  return new F(function(b, c) {
    c(a);
  });
}
function Ga(a) {
  return new F(function(b, c) {
    var d = a.length, e = [];
    if (d) {
      for (var k = function(a, c) {
        d--;
        e[a] = c;
        0 == d && b(e);
      }, g = function(a) {
        c(a);
      }, q = 0, t;t = a[q];q++) {
        Ha(t, ea(k, q), g);
      }
    } else {
      b(e);
    }
  });
}
F.prototype.then = function(a, b, c) {
  return Ia(this, h(a) ? a : null, h(b) ? b : null, c);
};
F.prototype.then = F.prototype.then;
F.prototype.$goog_Thenable = !0;
function Ha(a, b, c, d) {
  a instanceof F ? Ka(a, Ea(b || aa, c || null, d)) : a.then(b, c, d);
}
function Ka(a, b) {
  a.b || a.a != J && a.a != K || La(a);
  a.c ? a.c.next = b : a.b = b;
  a.c = b;
}
function Ia(a, b, c, d) {
  var e = Ea(null, null, null);
  e.a = new F(function(a, g) {
    e.f = b ? function(c) {
      try {
        var e = b.call(d, c);
        a(e);
      } catch (H) {
        g(H);
      }
    } : a;
    e.b = c ? function(b) {
      try {
        var e = c.call(d, b);
        a(e);
      } catch (H) {
        g(H);
      }
    } : g;
  });
  e.a.g = a;
  Ka(a, e);
  return e.a;
}
F.prototype.j = function(a) {
  this.a = G;
  I(this, J, a);
};
F.prototype.l = function(a) {
  this.a = G;
  I(this, K, a);
};
function I(a, b, c) {
  if (a.a == G) {
    if (a == c) {
      b = K, c = new TypeError("Promise cannot resolve to itself");
    } else {
      var d;
      if (c) {
        try {
          d = !!c.$goog_Thenable;
        } catch (e) {
          d = !1;
        }
      } else {
        d = !1;
      }
      if (d) {
        a.a = 1;
        Ha(c, a.j, a.l, a);
        return;
      }
      d = typeof c;
      if ("object" == d && null != c || "function" == d) {
        try {
          var k = c.then;
          if (h(k)) {
            Ma(a, c, k);
            return;
          }
        } catch (g) {
          b = K, c = g;
        }
      }
    }
    a.i = c;
    a.a = b;
    a.g = null;
    La(a);
    b != K || Na(a, c);
  }
}
function Ma(a, b, c) {
  function d(b) {
    k || (k = !0, a.l(b));
  }
  function e(b) {
    k || (k = !0, a.j(b));
  }
  a.a = 1;
  var k = !1;
  try {
    c.call(b, e, d);
  } catch (g) {
    d(g);
  }
}
function La(a) {
  a.h || (a.h = !0, xa(a.m, a));
}
function Oa(a) {
  var b = null;
  a.b && (b = a.b, a.b = b.next, b.next = null);
  a.b || (a.c = null);
  return b;
}
F.prototype.m = function() {
  for (var a = null;a = Oa(this);) {
    var b = this.a, c = this.i;
    if (b == K && a.b && !a.g) {
      for (var d = void 0, d = this;d && d.f;d = d.g) {
        d.f = !1;
      }
    }
    if (a.a) {
      a.a.g = null, Pa(a, b, c);
    } else {
      try {
        a.g ? a.f.call(a.c) : Pa(a, b, c);
      } catch (e) {
        Qa.call(null, e);
      }
    }
    ja(Ca, a);
  }
  this.h = !1;
};
function Pa(a, b, c) {
  b == J ? a.f.call(a.c, c) : a.b && a.b.call(a.c, c);
}
function Na(a, b) {
  a.f = !0;
  xa(function() {
    a.f && Qa.call(null, b);
  });
}
var Qa = ta;
var L = "undefined" !== typeof Promise;
function M(a) {
  return L ? new Promise(a) : new F(a);
}
function Ra(a) {
  return L ? Promise.all(a) : Ga(a);
}
;function Sa(a, b) {
  return M(function(c, d) {
    if (void 0 !== b) {
      var e = a.push(b, function(a) {
        a ? d(a) : c(e);
      })
    } else {
      c(a.push());
    }
  });
}
function Ta(a, b) {
  return M(function(c, d) {
    a.set(b, function(a) {
      a ? d(a) : c();
    });
  });
}
function Ua(a, b) {
  return M(function(c, d) {
    a.update(b, function(a) {
      a ? d(a) : c();
    });
  });
}
function Va(a, b) {
  return M(function(c, d) {
    a.transaction(b, function(a, b, g) {
      a ? d(a) : c({isCommitted:b, snapshot:g});
    }, !1);
  });
}
function Wa(a) {
  return M(function(b, c) {
    a.remove(function(a) {
      a ? c(a) : b();
    });
  });
}
function Xa(a, b) {
  return M(function(c, d) {
    a.once(b, function(a) {
      c(a);
    }, function(a) {
      d(a);
    });
  });
}
fa && require("firebase");
function N() {
  this.a = [];
}
N.b = function() {
  return N.a ? N.a : N.a = new N;
};
function O(a, b, c, d) {
  a: {
    var e = N.b();
    if (null === a) {
      b = [null], b = L ? Promise.resolve(b) : b instanceof F ? b : new F(Aa, b);
    } else {
      p("LOCAL_TRIGGER_GENERATED " + b.toUpperCase() + " at " + a.a());
      var k = [];
      a = a.a();
      for (var g = 0;g < e.a.length;g++) {
        var q = e.a[g][0], t = e.a[g][1], H = e.a[g][2], Da = e.a[g][3];
        if (t === b) {
          var T = a.match(q);
          if (T) {
            p("LOCAL_TRIGGER_MATCHED at " + q.toString() + " on " + t.toUpperCase() + " for " + Da.id());
            T.push(c);
            "value" === b && T.push(d);
            try {
              var qb = H.apply(Da, T.slice(1));
            } catch (Ja) {
              p("LOCAL_TRIGGER_FAILED at " + q.toString() + " on " + t.toUpperCase(), Ja);
              b = Ja;
              b = L ? Promise.reject(b) : Fa(b);
              break a;
            }
            k.push(qb);
          }
        }
      }
      b = Ra(k);
    }
  }
  return b;
}
function Ya(a, b) {
  return O(a, "child_added", b);
}
;function P(a) {
  this.a = a;
  this.G = {};
  this.v = !1;
  this.b = 0;
  this.u = [];
  this.l = Za(this);
}
m("onfire.Model", P);
P.prototype.H = function() {
  p("DISPOSE  " + this.a.a() + " ...");
  this.m();
  delete this.l;
  this.a.h(void 0, void 0, this);
  for (var a = 0;a < this.u.length;a++) {
    this.u[a].H();
  }
  p("DISPOSED " + this.a.a());
};
P.prototype.dispose = P.prototype.H;
function Za(a) {
  return M(function(b) {
    var c = !1;
    a.a.j(function(d) {
      a.f = d;
      a.b = v(d).length;
      c || (b(a), c = !0);
    }, void 0);
  });
}
P.prototype.m = function() {
  return this.a.l();
};
P.prototype.key = P.prototype.m;
P.prototype.F = function() {
  return !!this.f;
};
P.prototype.exists = P.prototype.F;
P.prototype.g = function(a) {
  return this.j(a) || this.i(a);
};
P.prototype.get = P.prototype.g;
P.prototype.i = function(a) {
  return this.f ? this.f[a] : null;
};
P.prototype.getBasicValue = P.prototype.i;
P.prototype.j = function(a) {
  return this[a + "Inst_"];
};
P.prototype.getModel = P.prototype.j;
P.prototype.h = function(a, b) {
  this.G[a] = b;
  this.v = !0;
  return this;
};
P.prototype.set = P.prototype.h;
P.prototype.L = function() {
  return this.v ? $a(this, this.G).then(function(a) {
    a.G = {};
    a.v = !1;
    return a;
  }) : L ? Promise.resolve(this) : this instanceof F ? this : new F(Aa, this);
};
P.prototype.save = P.prototype.L;
P.prototype.I = function() {
  return this.v;
};
P.prototype.hasChanges = P.prototype.I;
function $a(a, b) {
  var c = a.b, d = {}, e;
  for (e in b) {
    d[e] = a.g(e);
  }
  return a.a.A(b).then(function() {
    var c = [];
    for (e in b) {
      if (d[e] !== b[e]) {
        var g = O(a.a.g(e), "value", d[e], b[e]);
        c.push(g);
      }
    }
    return Ra(c);
  }).then(function() {
    if (0 < c && 0 === a.b) {
      p("REMOVED " + a.a.a());
      var b = a.a.f();
      return O(b, "child_removed", a);
    }
    if (0 === c && 0 < a.b) {
      return p("CREATED " + a.a.a()), Ya(a.a.f(), a);
    }
  }).then(function() {
    return a;
  });
}
function ab(a, b) {
  return a.a.w(function(a) {
    if (null === a) {
      return b;
    }
  }).then(function(b) {
    return b.isCommitted ? (p("CREATED " + a.a.a()), Ya(a.a.f(), a).then(function() {
      return b;
    })) : b;
  });
}
;function Q(a, b) {
  P.call(this, a);
  this.B = b || P;
}
n(Q, P);
m("onfire.Collection", Q);
Q.prototype.c = function(a) {
  return (new this.B(this.a.g(a))).l;
};
Q.prototype.fetchItem = Q.prototype.c;
Q.prototype.w = function(a) {
  var b = this.a.i(), b = this.c(b);
  a && (b = b.then(function(b) {
    return $a(b, a);
  }));
  return b;
};
Q.prototype.createItem = Q.prototype.w;
Q.prototype.A = function(a, b) {
  return this.c(a).then(function(a) {
    return b ? ab(a, b).then(function() {
      return a;
    }) : a;
  });
};
Q.prototype.fetchOrCreateItem = Q.prototype.A;
Q.prototype.D = function(a) {
  var b, c = this;
  return this.c(a).then(function(a) {
    b = a;
  }).then(function() {
    return c.h(a, null);
  }).then(function() {
    return O(c.a, "child_removed", b);
  }).then(function() {
    b.H();
  });
};
Q.prototype.removeItem = Q.prototype.D;
Q.prototype.forEach = function(a) {
  var b = [], c;
  for (c in this.f) {
    var d = this.c(c).then(function(b) {
      return a.call(null, b, c);
    });
    b.push(d);
  }
  return Ra(b);
};
Q.prototype.forEach = Q.prototype.forEach;
Q.prototype.C = function() {
  return this.b;
};
Q.prototype.count = Q.prototype.C;
Q.prototype.J = function() {
  return v(this.f);
};
Q.prototype.ids = Q.prototype.J;
function bb(a) {
  switch(typeof a) {
    case "function":
      return a;
    case "object":
      break;
    default:
      throw Error("Invalid config - it must be an object or a constructor!");;
  }
  return cb(a) === R ? db(a) : eb(a);
}
m("onfire.modelling.generateConstructor", bb);
function eb(a) {
  function b(b) {
    P.call(this, b);
    this.c(a);
  }
  n(b, P);
  fb(b, a);
  return b;
}
function db(a) {
  function b(a) {
    Q.call(this, a, c);
  }
  a = a.$id;
  var c;
  switch(cb(a)) {
    case gb:
      c = a;
      break;
    case hb:
    ;
    case R:
      c = eb(a);
  }
  n(b, Q);
  return b;
}
function fb(a, b) {
  for (var c in b) {
    if (0 != c.lastIndexOf("_", 0) && 0 != c.lastIndexOf("$", 0)) {
      var d = b[c];
      switch(cb(d)) {
        case ib:
        ;
        case jb:
        ;
        case kb:
          void 0 === a.prototype[c] ? a.prototype[c] = lb(c) : ga(c + " clashes with a built-in property or method. Use the generic .get(" + c + ") / .set(" + c + ", value) methods to access this property.");
          break;
        case gb:
        ;
        case hb:
        ;
        case R:
          a.prototype[c + "Ctor_"] = bb(d);
          void 0 === a.prototype[c] ? a.prototype[c] = mb(c) : ga(c + " clashes with a built-in property or method. Use the generic .getModel(" + c + ") method to access this property.");
          break;
        default:
          throw new TypeError("Invalid property type for " + c);;
      }
    }
  }
}
function cb(a) {
  switch(typeof a) {
    case "function":
      return gb;
    case "object":
      return void 0 !== a.$id ? R : hb;
  }
  switch(a) {
    case "string":
      return ib;
    case "number":
      return jb;
    case "boolean":
      return kb;
    default:
      return nb;
  }
}
function lb(a) {
  return function(b) {
    return 0 === arguments.length ? this.g(a) : this.h(a, b);
  };
}
function mb(a) {
  return function() {
    return this.g(a);
  };
}
var ib = 0, jb = 1, kb = 2, hb = 3, R = 4, gb = 5, nb = -1;
var ob = y("Opera") || y("OPR"), pb = sa(), rb = y("Gecko") && !(-1 != x.toLowerCase().indexOf("webkit") && !y("Edge")) && !(y("Trident") || y("MSIE")) && !y("Edge"), sb = -1 != x.toLowerCase().indexOf("webkit") && !y("Edge");
function tb() {
  var a = x;
  if (rb) {
    return /rv\:([^\);]+)(\)|;)/.exec(a);
  }
  if (pb && y("Edge")) {
    return /Edge\/([\d\.]+)/.exec(a);
  }
  if (pb) {
    return /\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);
  }
  if (sb) {
    return /WebKit\/(\S+)/.exec(a);
  }
}
(function() {
  if (ob && f.opera) {
    var a = f.opera.version;
    return h(a) ? a() : a;
  }
  var a = "", b = tb();
  b && (a = b ? b[1] : "");
  return pb && !y("Edge") && (b = (b = f.document) ? b.documentMode : void 0, b > parseFloat(a)) ? String(b) : a;
})();
var ub = /^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
function vb(a) {
  if (wb) {
    wb = !1;
    var b = f.location;
    if (b) {
      var c = b.href;
      if (c && (c = (c = vb(c)[3] || null) ? decodeURI(c) : c) && c != b.hostname) {
        throw wb = !0, Error();
      }
    }
  }
  return a.match(ub);
}
var wb = sb;
function xb(a, b) {
  for (var c = a.split("&"), d = 0;d < c.length;d++) {
    var e = c[d].indexOf("="), k = null, g = null;
    0 <= e ? (k = c[d].substring(0, e), g = c[d].substring(e + 1)) : k = c[d];
    b(k, g ? decodeURIComponent(g.replace(/\+/g, " ")) : "");
  }
}
;function S(a, b) {
  this.f = this.j = this.b = "";
  this.i = null;
  this.h = this.c = "";
  this.a = !1;
  var c;
  a instanceof S ? (this.a = void 0 !== b ? b : a.a, yb(this, a.b), this.j = a.j, this.f = a.f, zb(this, a.i), this.c = a.c, Ab(this, a.g.clone()), this.h = a.h) : a && (c = vb(String(a))) ? (this.a = !!b, yb(this, c[1] || "", !0), this.j = U(c[2] || ""), this.f = U(c[3] || "", !0), zb(this, c[4]), this.c = U(c[5] || "", !0), Ab(this, c[6] || "", !0), this.h = U(c[7] || "")) : (this.a = !!b, this.g = new V(null, 0, this.a));
}
S.prototype.toString = function() {
  var a = [], b = this.b;
  b && a.push(W(b, Bb, !0), ":");
  if (b = this.f) {
    a.push("//");
    var c = this.j;
    c && a.push(W(c, Bb, !0), "@");
    a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g, "%$1"));
    b = this.i;
    null != b && a.push(":", String(b));
  }
  if (b = this.c) {
    this.f && "/" != b.charAt(0) && a.push("/"), a.push(W(b, "/" == b.charAt(0) ? Cb : Db, !0));
  }
  (b = this.g.toString()) && a.push("?", b);
  (b = this.h) && a.push("#", W(b, Eb));
  return a.join("");
};
S.prototype.clone = function() {
  return new S(this);
};
function yb(a, b, c) {
  a.b = c ? U(b, !0) : b;
  a.b && (a.b = a.b.replace(/:$/, ""));
}
function zb(a, b) {
  if (b) {
    b = Number(b);
    if (isNaN(b) || 0 > b) {
      throw Error("Bad port number " + b);
    }
    a.i = b;
  } else {
    a.i = null;
  }
}
function Ab(a, b, c) {
  b instanceof V ? (a.g = b, Fb(a.g, a.a)) : (c || (b = W(b, Gb)), a.g = new V(b, 0, a.a));
}
function U(a, b) {
  return a ? b ? decodeURI(a.replace(/%25/g, "%2525")) : decodeURIComponent(a) : "";
}
function W(a, b, c) {
  return "string" == typeof a ? (a = encodeURI(a).replace(b, Hb), c && (a = a.replace(/%25([0-9a-fA-F]{2})/g, "%$1")), a) : null;
}
function Hb(a) {
  a = a.charCodeAt(0);
  return "%" + (a >> 4 & 15).toString(16) + (a & 15).toString(16);
}
var Bb = /[#\/\?@]/g, Db = /[\#\?:]/g, Cb = /[\#\?]/g, Gb = /[\#\?@]/g, Eb = /#/g;
function V(a, b, c) {
  this.c = this.a = null;
  this.b = a || null;
  this.f = !!c;
}
function X(a) {
  a.a || (a.a = new z, a.c = 0, a.b && xb(a.b, function(b, c) {
    var d = decodeURIComponent(b.replace(/\+/g, " "));
    X(a);
    a.b = null;
    var d = Y(a, d), e = C(a.a, d);
    e || A(a.a, d, e = []);
    e.push(c);
    a.c++;
  }));
}
function Ib(a, b) {
  X(a);
  b = Y(a, b);
  if (B(a.a.b, b)) {
    a.b = null;
    a.c -= C(a.a, b).length;
    var c = a.a;
    B(c.b, b) && (delete c.b[b], c.c--, c.f++, c.a.length > 2 * c.c && wa(c));
  }
}
V.prototype.clear = function() {
  this.a = this.b = null;
  this.c = 0;
};
V.prototype.o = function() {
  X(this);
  for (var a = this.a.s(), b = this.a.o(), c = [], d = 0;d < b.length;d++) {
    for (var e = a[d], k = 0;k < e.length;k++) {
      c.push(b[d]);
    }
  }
  return c;
};
V.prototype.s = function(a) {
  X(this);
  var b = [];
  if ("string" == typeof a) {
    var c = a;
    X(this);
    c = Y(this, c);
    B(this.a.b, c) && (b = la(b, C(this.a, Y(this, a))));
  } else {
    for (a = this.a.s(), c = 0;c < a.length;c++) {
      b = la(b, a[c]);
    }
  }
  return b;
};
V.prototype.toString = function() {
  if (this.b) {
    return this.b;
  }
  if (!this.a) {
    return "";
  }
  for (var a = [], b = this.a.o(), c = 0;c < b.length;c++) {
    for (var d = b[c], e = encodeURIComponent(String(d)), d = this.s(d), k = 0;k < d.length;k++) {
      var g = e;
      "" !== d[k] && (g += "=" + encodeURIComponent(String(d[k])));
      a.push(g);
    }
  }
  return this.b = a.join("&");
};
V.prototype.clone = function() {
  var a = new V;
  a.b = this.b;
  this.a && (a.a = this.a.clone(), a.c = this.c);
  return a;
};
function Y(a, b) {
  var c = String(b);
  a.f && (c = c.toLowerCase());
  return c;
}
function Fb(a, b) {
  b && !a.f && (X(a), a.b = null, a.a.forEach(function(a, b) {
    var e = b.toLowerCase();
    if (b != e && (Ib(this, b), Ib(this, e), 0 < a.length)) {
      this.b = null;
      var k = this.a, e = Y(this, e), g;
      g = a.length;
      if (0 < g) {
        for (var q = Array(g), t = 0;t < g;t++) {
          q[t] = a[t];
        }
        g = q;
      } else {
        g = [];
      }
      A(k, e, g);
      this.c += a.length;
    }
  }, a));
  a.f = b;
}
;function Z(a) {
  this.b = a;
}
m("onfire.Ref", Z);
Z.prototype.g = function(a, b) {
  var c = this.b.child(a);
  return new Z(null != b ? c.child(b) : c);
};
Z.prototype.child = Z.prototype.g;
Z.prototype.D = function() {
  return new Z(this.b.root());
};
Z.prototype.root = Z.prototype.D;
Z.prototype.push = function(a) {
  p("PUSH " + this.a() + " :", a);
  var b = this;
  return Sa(this.b, a).then(function(c) {
    p("PUSH (Success) " + b.a() + " :", a);
    return new Z(c);
  }, function(c) {
    u("PUSH (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
Z.prototype.push = Z.prototype.push;
Z.prototype.i = function() {
  return this.b.push().key();
};
Z.prototype.generateId = Z.prototype.i;
Z.prototype.F = function(a) {
  p("SET " + this.a() + " :", a);
  var b = this;
  return Ta(this.b, a).then(function() {
    p("SET (Success) " + b.a() + " :", a);
    return null;
  }, function(c) {
    u("SET (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
Z.prototype.set = Z.prototype.F;
Z.prototype.A = function(a) {
  p("UPDATE " + this.a() + " :", a);
  var b = this;
  return Ua(this.b, a).then(function() {
    p("UPDATE (Success) " + b.a() + " :", a);
    return null;
  }, function(c) {
    u("UPDATE (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
Z.prototype.update = Z.prototype.A;
Z.prototype.w = function(a) {
  p("TRANSACTION at " + this.a());
  var b = this;
  return Va(this.b, a).then(function(a) {
    p("TRANSACTION " + (a.isCommitted ? "Committed" : "Not Committed") + " at " + b.a() + " :", a.snapshot.val());
    return a;
  }, function(a) {
    u("TRANSACTION Failed at " + b.a());
    throw a;
  });
};
Z.prototype.transaction = Z.prototype.w;
Z.prototype.C = function() {
  p("REMOVE " + this.a());
  var a = this;
  return Wa(this.b).then(function() {
    p("REMOVE (Success) " + a.a());
    return null;
  }, function(b) {
    u("REMOVE (Failure) " + a.a(), b);
    throw b;
  });
};
Z.prototype.remove = Z.prototype.C;
Z.prototype.u = function(a) {
  p("ONCE " + a.toUpperCase() + " " + this.a());
  var b = this;
  return Xa(this.b, a).then(function(c) {
    p("ONCE " + a.toUpperCase() + " (Success) " + b.a(), c.val());
    return c;
  }, function(c) {
    u("ONCE " + a.toUpperCase() + " (Failure) " + b.a(), c);
    throw c;
  });
};
Z.prototype.once = Z.prototype.u;
Z.prototype.J = function() {
  return this.u("value").then(function(a) {
    return a.val();
  });
};
Z.prototype.onceValue = Z.prototype.J;
Z.prototype.m = function(a, b, c, d) {
  var e = this;
  return this.b.on(a, function(c, g) {
    p(a.toUpperCase() + " at " + e.a(), c.val());
    b.call(d, c, g);
  }, function(b) {
    u(a.toUpperCase() + " CANCELLED at " + e.a(), b);
    "function" === typeof c && c.call(d, b);
  });
};
Z.prototype.on = Z.prototype.m;
Z.prototype.h = function(a, b, c) {
  this.b.off(a, b, c);
};
Z.prototype.off = Z.prototype.h;
Z.prototype.j = function(a, b, c) {
  return this.m("value", function(b) {
    a.call(c, b.val());
  }, b, c);
};
Z.prototype.onValue = Z.prototype.j;
Z.prototype.I = function(a, b) {
  this.h("value", a, b);
};
Z.prototype.offValue = Z.prototype.I;
Z.prototype.B = function() {
  return this.b;
};
Z.prototype.ref = Z.prototype.B;
Z.prototype.f = function() {
  var a = this.b.parent();
  return a ? new Z(a) : null;
};
Z.prototype.parent = Z.prototype.f;
Z.prototype.l = function() {
  return this.b.key();
};
Z.prototype.key = Z.prototype.l;
Z.prototype.a = function() {
  var a;
  if (!(a = this.c)) {
    a = decodeURIComponent;
    var b = this.b.toString(), b = (b instanceof S ? b.clone() : new S(b, void 0)).c;
    a = this.c = a(b) || "/";
  }
  return a;
};
Z.prototype.path = Z.prototype.a;
fa && (module.exports = {Ref:Z, Model:P, Collection:Q, modelling:{generateConstructor:bb}});
})();//# sourceMappingURL=./onfire.min.js.map
