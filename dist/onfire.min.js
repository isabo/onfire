(function(){var e=this;function aa(){}
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function g(a){return"function"==ba(a)}function ca(a,b,c){return a.call.apply(a.bind,arguments)}function da(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function h(a,b,c){h=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:da;return h.apply(null,arguments)}function ea(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}function m(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)c.length||void 0===b?d[f]?d=d[f]:d=d[f]={}:d[f]=b}
function fa(a,b){function c(){}c.prototype=b.prototype;a.aa=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.$=function(a,c,l){for(var k=Array(arguments.length-2),q=2;q<arguments.length;q++)k[q-2]=arguments[q];return b.prototype[c].apply(a,k)}};m("onfire.model.Error",{INVALID_REF:"Invalid ref argument - it must be an onfire.Ref instance",NOT_LOADED:"Not loaded yet",NO_SUCH_KEY:"No such key",NOT_A_MODEL:"Not a model",NOT_A_PRIMITIVE:"Not a primitive"});function n(a){switch(typeof a){case "function":return ga;case "object":return void 0!==a.$id?p:r}switch(a){case "string":return ha;case "number":return ia;case "boolean":return ja;default:return ka}}var ha=0,ia=1,ja=2,r=3,p=4,ga=5,ka=-1;var la="undefined"!==typeof module&&!!module.exports;function t(a){ma("info",arguments)}function na(a){ma("warn",arguments)}function v(a){ma("error",arguments)}function ma(a,b){var c=Array.prototype.slice.call(b,0);c.unshift("ONFIRE:");"function"===typeof console[a]?console[a].apply(console,c):console.log.apply(console,c)};function oa(a,b){this.c=a;this.f=b;this.b=0;this.a=null}function pa(a){var b;0<a.b?(a.b--,b=a.a,a.a=b.next,b.next=null):b=a.c();return b}function qa(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function ra(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};var sa=Array.prototype;function ta(a){return sa.concat.apply(sa,arguments)};function ua(){this.b=this.a=null}var wa=new oa(function(){return new va},function(a){a.reset()});function xa(){var a=ya,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function va(){this.next=this.b=this.a=null}va.prototype.reset=function(){this.next=this.b=this.a=null};var w;a:{var za=e.navigator;if(za){var Aa=za.userAgent;if(Aa){w=Aa;break a}}w=""}function x(a){return-1!=w.indexOf(a)};function Ba(){return x("Edge")||x("Trident")||x("MSIE")};function Ca(a){e.setTimeout(function(){throw a;},0)}var Da;
function Ea(){var a=e.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!x("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=h(function(a){if(("*"==d||a.origin==d)&&a.data==
c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!Ba()){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.W;c.W=null;a()}};return function(a){d.next={W:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=
function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){e.setTimeout(a,0)}};function y(a,b){this.b={};this.a=[];this.f=this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)z(this,arguments[d],arguments[d+1])}else if(a){if(a instanceof y)c=a.D(),d=a.F();else{var c=ra(a),f=[],l=0;for(d in a)f[l++]=a[d];d=f}for(f=0;f<c.length;f++)z(this,c[f],d[f])}}y.prototype.F=function(){Fa(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};y.prototype.D=function(){Fa(this);return this.a.concat()};
y.prototype.clear=function(){this.b={};this.f=this.c=this.a.length=0};function Fa(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];A(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){for(var f={},c=b=0;b<a.a.length;)d=a.a[b],A(f,d)||(a.a[c++]=d,f[d]=1),b++;a.a.length=c}}function B(a,b){return A(a.b,b)?a.b[b]:void 0}function z(a,b,c){A(a.b,b)||(a.c++,a.a.push(b),a.f++);a.b[b]=c}
y.prototype.forEach=function(a,b){for(var c=this.D(),d=0;d<c.length;d++){var f=c[d];a.call(b,B(this,f),f,this)}};y.prototype.clone=function(){return new y(this)};function A(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Ha(a,b){C||Ia();D||(C(),D=!0);var c=ya,d=pa(wa);d.a=a;d.b=b;d.next=null;c.b?c.b.next=d:c.a=d;c.b=d}var C;function Ia(){if(e.Promise&&e.Promise.resolve){var a=e.Promise.resolve();C=function(){a.then(Ja)}}else C=function(){var a=Ja;!g(e.setImmediate)||e.Window&&e.Window.prototype&&e.Window.prototype.setImmediate==e.setImmediate?(Da||(Da=Ea()),Da(a)):e.setImmediate(a)}}var D=!1,ya=new ua;[].push(function(){D=!1;ya=new ua});
function Ja(){for(var a=null;a=xa();){try{a.a.call(a.b)}catch(b){Ca(b)}qa(wa,a)}D=!1};function E(a,b){this.a=F;this.i=void 0;this.c=this.b=this.g=null;this.f=this.h=!1;if(a==Ka)G(this,H,b);else try{var c=this;a.call(b,function(a){G(c,H,a)},function(a){try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}G(c,I,a)})}catch(d){G(this,I,d)}}var F=0,H=2,I=3;function La(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}La.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var Na=new oa(function(){return new La},function(a){a.reset()});
function Oa(a,b,c){var d=pa(Na);d.f=a;d.b=b;d.c=c;return d}function Ka(){}function Pa(a){return new E(function(b,c){c(a)})}function Qa(a){return new E(function(b,c){var d=a.length,f=[];if(d)for(var l=function(a,c){d--;f[a]=c;0==d&&b(f)},k=function(a){c(a)},q=0,u;u=a[q];q++)Ra(u,ea(l,q),k);else b(f)})}E.prototype.then=function(a,b,c){return Sa(this,g(a)?a:null,g(b)?b:null,c)};E.prototype.then=E.prototype.then;E.prototype.$goog_Thenable=!0;
function Ra(a,b,c,d){a instanceof E?Ta(a,Oa(b||aa,c||null,d)):a.then(b,c,d)}function Ta(a,b){a.b||a.a!=H&&a.a!=I||Ua(a);a.c?a.c.next=b:a.b=b;a.c=b}function Sa(a,b,c,d){var f=Oa(null,null,null);f.a=new E(function(a,k){f.f=b?function(c){try{var f=b.call(d,c);a(f)}catch(J){k(J)}}:a;f.b=c?function(b){try{var f=c.call(d,b);a(f)}catch(J){k(J)}}:k});f.a.g=a;Ta(a,f);return f.a}E.prototype.j=function(a){this.a=F;G(this,H,a)};E.prototype.l=function(a){this.a=F;G(this,I,a)};
function G(a,b,c){if(a.a==F){if(a==c)b=I,c=new TypeError("Promise cannot resolve to itself");else{var d;if(c)try{d=!!c.$goog_Thenable}catch(f){d=!1}else d=!1;if(d){a.a=1;Ra(c,a.j,a.l,a);return}d=typeof c;if("object"==d&&null!=c||"function"==d)try{var l=c.then;if(g(l)){Va(a,c,l);return}}catch(k){b=I,c=k}}a.i=c;a.a=b;a.g=null;Ua(a);b!=I||Wa(a,c)}}function Va(a,b,c){function d(b){l||(l=!0,a.l(b))}function f(b){l||(l=!0,a.j(b))}a.a=1;var l=!1;try{c.call(b,f,d)}catch(k){d(k)}}
function Ua(a){a.h||(a.h=!0,Ha(a.m,a))}function Xa(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.c=null);return b}E.prototype.m=function(){for(var a=null;a=Xa(this);){var b=this.a,c=this.i;if(b==I&&a.b&&!a.g)for(var d=void 0,d=this;d&&d.f;d=d.g)d.f=!1;if(a.a)a.a.g=null,Ya(a,b,c);else try{a.g?a.f.call(a.c):Ya(a,b,c)}catch(f){Za.call(null,f)}qa(Na,a)}this.h=!1};function Ya(a,b,c){b==H?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Wa(a,b){a.f=!0;Ha(function(){a.f&&Za.call(null,b)})}
var Za=Ca;var K="undefined"!==typeof Promise;function L(a){return K?new Promise(a):new E(a)}function M(a){return K?Promise.resolve(a):a instanceof E?a:new E(Ka,a)}function N(a){return K?Promise.all(a):Qa(a)};var $a=la?require("firebase"):Firebase;function ab(a,b){return L(function(c,d){if(void 0!==b)var f=a.push(b,function(a){a?d(a):c(f)});else c(a.push())})}function bb(a,b){return L(function(c,d){a.set(b,function(a){a?d(a):c()})})}function cb(a,b){return L(function(c,d){a.update(b,function(a){a?d(a):c()})})}function db(a,b){return L(function(c,d){a.transaction(b,function(a,b,k){a?d(a):c({isCommitted:b,snapshot:k})},!1)})}function eb(a){return L(function(b,c){a.remove(function(a){a?c(a):b()})})}
function fb(a,b){return L(function(c,d){a.once(b,function(a){c(a)},function(a){d(a)})})}function gb(a,b,c){return L(function(d,f){a.authWithCustomToken(b,function(a,b){a?f(a):d(b)},c)})}function hb(a,b){return L(function(c,d){a.authAnonymously(function(a,b){a?d(a):c(b)},b)})}function ib(a,b,c){return L(function(d,f){a.authWithPassword(b,function(a,b){a?f(a):d(b)},c)})}function jb(a,b,c){return L(function(d,f){a.authWithOAuthPopup(b,function(a,b){a?f(a):d(b)},c)})}
function kb(a,b,c){return L(function(d,f){a.authWithOAuthRedirect(b,function(a){f(a)},c)})}function lb(a,b,c,d){return L(function(f,l){a.authWithOAuthToken(b,c,function(a,b){a?l(a):f(b)},d)})}function mb(a,b){return L(function(c,d){a.createUser(b,function(a,b){a?d(a):c(b)})})}function nb(a,b){return L(function(c,d){a.changeEmail(b,function(a){a?d(a):c()})})}function ob(a,b){return L(function(c,d){a.changePassword(b,function(a){a?d(a):c()})})}
function pb(a,b){return L(function(c,d){a.removeUser(b,function(a){a?d(a):c()})})}function qb(a,b){return L(function(c,d){a.resetPassword(b,function(a){a?d(a):c()})})};function O(){this.a=[]}O.b=function(){return O.a?O.a:O.a=new O};
function P(a,b,c,d){a:{var f=O.b();if(null===a)b=M([null]);else{t("LOCAL_TRIGGER_GENERATED "+b.toUpperCase()+" at "+a.b());var l=[];a=a.b();for(var k=0;k<f.a.length;k++){var q=f.a[k][0],u=f.a[k][1],J=f.a[k][2],Ga=f.a[k][3];if(u===b){var Y=a.match(q);if(Y){t("LOCAL_TRIGGER_MATCHED at "+q.toString()+" on "+u.toUpperCase()+" for "+Ga.id());Y.push(c);"value"===b&&Y.push(d);try{var Fb=J.apply(Ga,Y.slice(1))}catch(Ma){t("LOCAL_TRIGGER_FAILED at "+q.toString()+" on "+u.toUpperCase(),Ma);b=Ma;b=K?Promise.reject(b):
Pa(b);break a}l.push(Fb)}}}b=N(l)}}return b}function rb(a,b){return P(a,"child_added",b)};var sb=x("Opera")||x("OPR"),tb=Ba(),ub=x("Gecko")&&!(-1!=w.toLowerCase().indexOf("webkit")&&!x("Edge"))&&!(x("Trident")||x("MSIE"))&&!x("Edge"),vb=-1!=w.toLowerCase().indexOf("webkit")&&!x("Edge");function wb(){var a=w;if(ub)return/rv\:([^\);]+)(\)|;)/.exec(a);if(tb&&x("Edge"))return/Edge\/([\d\.]+)/.exec(a);if(tb)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(vb)return/WebKit\/(\S+)/.exec(a)}
(function(){if(sb&&e.opera){var a=e.opera.version;return g(a)?a():a}var a="",b=wb();b&&(a=b?b[1]:"");return tb&&!x("Edge")&&(b=(b=e.document)?b.documentMode:void 0,b>parseFloat(a))?String(b):a})();var xb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function yb(a){if(zb){zb=!1;var b=e.location;if(b){var c=b.href;if(c&&(c=(c=yb(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw zb=!0,Error();}}return a.match(xb)}var zb=vb;
function Ab(a,b){for(var c=a.split("&"),d=0;d<c.length;d++){var f=c[d].indexOf("="),l=null,k=null;0<=f?(l=c[d].substring(0,f),k=c[d].substring(f+1)):l=c[d];b(l,k?decodeURIComponent(k.replace(/\+/g," ")):"")}};function Q(a,b){this.f=this.j=this.b="";this.i=null;this.h=this.c="";this.a=!1;var c;a instanceof Q?(this.a=void 0!==b?b:a.a,Bb(this,a.b),this.j=a.j,this.f=a.f,Cb(this,a.i),this.c=a.c,Db(this,a.g.clone()),this.h=a.h):a&&(c=yb(String(a)))?(this.a=!!b,Bb(this,c[1]||"",!0),this.j=R(c[2]||""),this.f=R(c[3]||"",!0),Cb(this,c[4]),this.c=R(c[5]||"",!0),Db(this,c[6]||"",!0),this.h=R(c[7]||"")):(this.a=!!b,this.g=new S(null,0,this.a))}
Q.prototype.toString=function(){var a=[],b=this.b;b&&a.push(T(b,Eb,!0),":");if(b=this.f){a.push("//");var c=this.j;c&&a.push(T(c,Eb,!0),"@");a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.i;null!=b&&a.push(":",String(b))}if(b=this.c)this.f&&"/"!=b.charAt(0)&&a.push("/"),a.push(T(b,"/"==b.charAt(0)?Gb:Hb,!0));(b=this.g.toString())&&a.push("?",b);(b=this.h)&&a.push("#",T(b,Ib));return a.join("")};Q.prototype.clone=function(){return new Q(this)};
function Bb(a,b,c){a.b=c?R(b,!0):b;a.b&&(a.b=a.b.replace(/:$/,""))}function Cb(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.i=b}else a.i=null}function Db(a,b,c){b instanceof S?(a.g=b,Jb(a.g,a.a)):(c||(b=T(b,Kb)),a.g=new S(b,0,a.a))}function R(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function T(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Lb),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}
function Lb(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Eb=/[#\/\?@]/g,Hb=/[\#\?:]/g,Gb=/[\#\?]/g,Kb=/[\#\?@]/g,Ib=/#/g;function S(a,b,c){this.c=this.a=null;this.b=a||null;this.f=!!c}function U(a){a.a||(a.a=new y,a.c=0,a.b&&Ab(a.b,function(b,c){var d=decodeURIComponent(b.replace(/\+/g," "));U(a);a.b=null;var d=V(a,d),f=B(a.a,d);f||z(a.a,d,f=[]);f.push(c);a.c++}))}
function Mb(a,b){U(a);b=V(a,b);if(A(a.a.b,b)){a.b=null;a.c-=B(a.a,b).length;var c=a.a;A(c.b,b)&&(delete c.b[b],c.c--,c.f++,c.a.length>2*c.c&&Fa(c))}}S.prototype.clear=function(){this.a=this.b=null;this.c=0};S.prototype.D=function(){U(this);for(var a=this.a.F(),b=this.a.D(),c=[],d=0;d<b.length;d++)for(var f=a[d],l=0;l<f.length;l++)c.push(b[d]);return c};
S.prototype.F=function(a){U(this);var b=[];if("string"==typeof a){var c=a;U(this);c=V(this,c);A(this.a.b,c)&&(b=ta(b,B(this.a,V(this,a))))}else for(a=this.a.F(),c=0;c<a.length;c++)b=ta(b,a[c]);return b};S.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";for(var a=[],b=this.a.D(),c=0;c<b.length;c++)for(var d=b[c],f=encodeURIComponent(String(d)),d=this.F(d),l=0;l<d.length;l++){var k=f;""!==d[l]&&(k+="="+encodeURIComponent(String(d[l])));a.push(k)}return this.b=a.join("&")};
S.prototype.clone=function(){var a=new S;a.b=this.b;this.a&&(a.a=this.a.clone(),a.c=this.c);return a};function V(a,b){var c=String(b);a.f&&(c=c.toLowerCase());return c}function Jb(a,b){b&&!a.f&&(U(a),a.b=null,a.a.forEach(function(a,b){var f=b.toLowerCase();if(b!=f&&(Mb(this,b),Mb(this,f),0<a.length)){this.b=null;var l=this.a,f=V(this,f),k;k=a.length;if(0<k){for(var q=Array(k),u=0;u<k;u++)q[u]=a[u];k=q}else k=[];z(l,f,k);this.c+=a.length}},a));a.f=b};function W(a){"string"===typeof a&&(a=la?new $a(a):new Firebase(a));this.a=a}m("onfire.Ref",W);W.prototype.authWithCustomToken=function(a,b){return gb(this.a,a,b)};W.prototype.authWithCustomToken=W.prototype.authWithCustomToken;W.prototype.A=function(a){return hb(this.a,a)};W.prototype.authAnonymously=W.prototype.A;W.prototype.I=function(a,b){return ib(this.a,a,b)};W.prototype.authWithPassword=W.prototype.I;W.prototype.B=function(a,b){return jb(this.a,a,b)};W.prototype.authWithOAuthPopup=W.prototype.B;
W.prototype.C=function(a,b){return kb(this.a,a,b)};W.prototype.authWithOAuthRedirect=W.prototype.C;W.prototype.H=function(a,b,c){return lb(this.a,a,b,c)};W.prototype.authWithOAuthToken=W.prototype.H;W.prototype.J=function(a){return nb(this.a,a)};W.prototype.changeEmail=W.prototype.J;W.prototype.K=function(a){return ob(this.a,a)};W.prototype.changePassword=W.prototype.K;W.prototype.L=function(a){return mb(this.a,a)};W.prototype.createUser=W.prototype.L;W.prototype.M=function(){return this.a.getAuth()};
W.prototype.getAuth=W.prototype.M;W.prototype.O=function(){this.a.goOnline()};W.prototype.goOnline=W.prototype.O;W.prototype.N=function(){this.a.goOffline()};W.prototype.goOffline=W.prototype.N;W.prototype.R=function(a,b){this.a.onAuth(a,b)};W.prototype.onAuth=W.prototype.R;W.prototype.P=function(a,b){this.a.offAuth(a,b)};W.prototype.offAuth=W.prototype.P;W.prototype.Z=function(){this.a.unauth()};W.prototype.unauth=W.prototype.Z;W.prototype.f=function(a){return new W(this.a.child(a))};
W.prototype.child=W.prototype.f;W.prototype.j=function(){return this.a.push().key()};W.prototype.generateId=W.prototype.j;W.prototype.s=function(){return this.a.key()};W.prototype.key=W.prototype.s;W.prototype.i=function(a,b,c){this.a.off(a,b,c)};W.prototype.off=W.prototype.i;W.prototype.G=function(a,b){this.i("value",a,b)};W.prototype.offValue=W.prototype.G;
W.prototype.g=function(a,b,c,d){var f=this;return this.a.on(a,function(c,k){t(a.toUpperCase()+" at "+f.b(),c.val());b.call(d,c,k)},function(b){v(a.toUpperCase()+" CANCELLED at "+f.b(),b);"function"===typeof c&&c.call(d,b)})};W.prototype.on=W.prototype.g;
W.prototype.u=function(a){t("ONCE "+a.toUpperCase()+" "+this.b());var b=this;return fb(this.a,a).then(function(c){t("ONCE "+a.toUpperCase()+" (Success) "+b.b(),c.val());return c},function(c){v("ONCE "+a.toUpperCase()+" (Failure) "+b.b(),c);throw c;})};W.prototype.once=W.prototype.u;W.prototype.m=function(){return this.u("value").then(function(a){return a.val()})};W.prototype.onceValue=W.prototype.m;W.prototype.l=function(a,b,c){return this.g("value",function(b){a.call(c,b.val())},b,c)};
W.prototype.onValue=W.prototype.l;W.prototype.h=function(){var a=this.a.parent();return a?new W(a):null};W.prototype.parent=W.prototype.h;W.prototype.b=function(){var a;if(!(a=this.c)){a=decodeURIComponent;var b=this.a.toString(),b=(b instanceof Q?b.clone():new Q(b,void 0)).c;a=this.c=a(b)||"/"}return a};W.prototype.path=W.prototype.b;
W.prototype.push=function(a){t("PUSH "+this.b()+" :",a);var b=this;return ab(this.a,a).then(function(c){t("PUSH (Success) "+b.b()+" :",a);return new W(c)},function(c){v("PUSH (Failure) "+b.b()+" :",a,c);throw c;})};W.prototype.push=W.prototype.push;W.prototype.S=function(){return this.a};W.prototype.ref=W.prototype.S;
W.prototype.T=function(){t("REMOVE "+this.b());var a=this;return eb(this.a).then(function(){t("REMOVE (Success) "+a.b());return null},function(b){v("REMOVE (Failure) "+a.b(),b);throw b;})};W.prototype.remove=W.prototype.T;W.prototype.U=function(a){return pb(this.a,a)};W.prototype.removeUser=W.prototype.U;W.prototype.V=function(a){return qb(this.a,a)};W.prototype.resetPassword=W.prototype.V;W.prototype.X=function(){return new W(this.a.root())};W.prototype.root=W.prototype.X;
W.prototype.Y=function(a){t("SET "+this.b()+" :",a);var b=this;return bb(this.a,a).then(function(){t("SET (Success) "+b.b()+" :",a);return null},function(c){v("SET (Failure) "+b.b()+" :",a,c);throw c;})};W.prototype.set=W.prototype.Y;W.prototype.v=function(a){t("TRANSACTION at "+this.b());var b=this;return db(this.a,a).then(function(a){t("TRANSACTION "+(a.isCommitted?"Committed":"Not Committed")+" at "+b.b()+" :",a.snapshot.val());return a},function(a){v("TRANSACTION Failed at "+b.b());throw a;})};
W.prototype.transaction=W.prototype.v;W.prototype.w=function(a){t("UPDATE "+this.b()+" :",a);var b=this;return cb(this.a,a).then(function(){t("UPDATE (Success) "+b.b()+" :",a);return null},function(c){v("UPDATE (Failure) "+b.b()+" :",a,c);throw c;})};W.prototype.update=W.prototype.w;function X(a){if(!(a instanceof W))throw Error("Invalid ref argument - it must be an onfire.Ref instance");this.a=a;this.s={};this.l=!1;this.h=0;this.g=null;this.B=[];this.u=[];this.o=this.J()}m("onfire.model.Model",X);X.prototype.G=function(){t("DISPOSE  "+this.a.b()+" ...");delete this.o;for(var a=0;a<this.u.length;a++)this.a.i.apply(this.a,this.u[a]);this.C=null;for(a=0;a<this.B.length;a++)this.B[a].G();t("DISPOSED "+this.a.b())};X.prototype.dispose=X.prototype.G;
function Nb(a,b){a.g=b;var c=[],d;for(d in a.g){var f;switch(n(a.g[d])){case ha:case ia:case ja:break;case r:case p:f=a[d+"Ctor_"];a[d+"Inst_"]=new f(a.a.f(d));c.push(a[d+"Inst_"].o);a.B.push(a[d+"Inst_"]);break;default:throw new TypeError("Invalid property type for "+d);}}a.o=a.o.then(function(){return N(c)}).then(function(){a.b=!0;return a});a.b=!1}
X.prototype.J=function(){var a=this;return L(function(b,c){a.b=!1;var d=a.a.l(function(c){var d=a.b;Ob(a,c);d||b(a)},function(b){a.b||c(b)});a.u.push(["value",d])})};X.prototype.V=function(){return this.o};X.prototype.whenLoaded=X.prototype.V;X.prototype.H=function(){return this.a.s()};X.prototype.key=X.prototype.H;X.prototype.U=function(){if(!this.b)throw Error("Not loaded yet");return!!this.c};X.prototype.exists=X.prototype.U;X.prototype.O=function(a){this.C=a};X.prototype.onValueChanged=X.prototype.O;
function Ob(a,b){a.c=b;a.h=ra(b).length;a.b=!0;a.C&&a.C.call(null,a)}X.prototype.v=function(a){return a in this.g&&"string"!==typeof this.g[a]?this.j(a):this.i(a)};X.prototype.get=X.prototype.v;X.prototype.i=function(a){if(!this.b)throw Error("Not loaded yet");if(this.c&&a in this.c)return this.c[a];if(a in this.g)return null;throw Error("No such key");};X.prototype.getBasicValue=X.prototype.i;
X.prototype.j=function(a){if(!this.b)throw Error("Not loaded yet");if(!(a in this.g))throw Error("No such key");if("string"===typeof this.g[a])throw Error("Not a model");return this[a+"Inst_"]};X.prototype.getModel=X.prototype.j;X.prototype.w=function(a,b){if(!this.b)throw Error("Not loaded yet");var c=a in this.g,d=this.c&&a in this.c;if(!c&&!d)throw Error("No such key");if(c&&"string"!==typeof this.g[a])throw Error("Not a primitive");this.s[a]=b;this.l=!0;return this};X.prototype.set=X.prototype.w;
X.prototype.N=function(){return this.l};X.prototype.hasChanges=X.prototype.N;X.prototype.I=function(){return this.l?Pb(this,this.s).then(function(a){a.s={};a.l=!1;return a}):M(this)};X.prototype.save=X.prototype.I;
function Pb(a,b){var c=a.h,d={},f;for(f in b)try{d[f]=a.i(f)}catch(l){}return a.a.w(b).then(function(){var c=[];for(f in b)if(d[f]!==b[f]){var l=a.a.f(f),l=P(l,"value",d[f],b[f]);c.push(l)}return N(c)}).then(function(){if(0<c&&0===a.h){t("REMOVED "+a.a.b());var b=a.a.h(),d=a.H();return P(b,"child_removed",a,d)}if(0===c&&0<a.h)return t("CREATED "+a.a.b()),rb(a.a.h(),a)}).then(function(){return a})}
function Qb(a,b){return a.a.v(function(a){if(null===a)return b}).then(function(b){return b.isCommitted?(t("CREATED "+a.a.b()),rb(a.a.h(),a).then(function(){return b})):b})};function Z(a,b){X.call(this,a);this.f=b}fa(Z,X);m("onfire.model.Collection",Z);Z.prototype.J=function(){var a=this,b=this.a.m().then(function(b){Ob(a,b);return a});b.then(function(){var b=a.a.g("child_added",a.L,void 0,a),d=a.a.g("child_removed",a.M,void 0,a);a.u.push(["child_added",b,a]);a.u.push(["child_removed",d,a])});return b};Z.prototype.v=function(a){return this.f?this.j(a):this.i(a)};Z.prototype.get=Z.prototype.v;
Z.prototype.j=function(a){if(!this.b)throw Error("Not loaded yet");if(!this.f)throw Error("Not a model");if(!this.m(a))throw Error("No such key");return new this.f(this.a.f(a))};Z.prototype.getModel=Z.prototype.j;Z.prototype.i=function(a){if(!this.b)throw Error("Not loaded yet");if(!this.m(a))throw Error("No such key");return this.c[a]};Z.prototype.getBasicValue=Z.prototype.i;
Z.prototype.w=function(a,b){if(!this.b)throw Error("Not loaded yet");if(this.f)throw Error("Not a primitive");this.s[a]=b;this.l=!0;return this};Z.prototype.set=Z.prototype.w;Z.prototype.A=function(a){return this.j(a).o};Z.prototype.fetch=Z.prototype.A;Z.prototype.R=function(a){if(!this.b)throw Error("Not loaded yet");if(!this.f)throw Error("Not a model");var b=this.a.j(),b=(new this.f(this.a.f(b))).o;a&&(b=b.then(function(b){return Pb(b,a)}));return b};Z.prototype.create=Z.prototype.R;
Z.prototype.K=function(a,b){if(!this.b)throw Error("Not loaded yet");if(!this.f)throw Error("Not a model");return(new this.f(this.a.f(a))).o.then(function(a){return b?Qb(a,b).then(function(){return a}):a})};Z.prototype.fetchOrCreate=Z.prototype.K;
Z.prototype.T=function(a){if(!this.b)throw Error("Not loaded yet");if(!this.m(a))return M(null);var b,c=this;return(this.f?this.A(a):M(this.i(a))).then(function(a){b=a}).then(function(){c.s[a]=null;c.l=!0;return c.I()}).then(function(){return P(c.a,"child_removed",b,a)}).then(function(){b instanceof X&&b.G()})};Z.prototype.remove=Z.prototype.T;
Z.prototype.forEach=function(a){if(!this.b)throw Error("Not loaded yet");var b=[],c;for(c in this.c){var d=this.f?this.A(c):M(this.i(c)),d=d.then(function(b){return a.call(null,b,c)});b.push(d)}return N(b)};Z.prototype.forEach=Z.prototype.forEach;Z.prototype.P=function(){if(!this.b)throw Error("Not loaded yet");return this.h};Z.prototype.count=Z.prototype.P;Z.prototype.m=function(a){if(!this.b)throw Error("Not loaded yet");return!!this.c&&a in this.c};Z.prototype.containsKey=Z.prototype.m;
Z.prototype.S=function(){if(!this.b)throw Error("Not loaded yet");return ra(this.c)};Z.prototype.keys=Z.prototype.S;Z.prototype.L=function(a){this.c||(this.c={});var b=a.key(),c=!this.m(b);this.c[b]=a.val();c&&this.h++};Z.prototype.M=function(a){a=a.key();this.m(a)&&(delete this.c[a],this.h--,0===this.h&&(this.c=null))};function Rb(a){switch(typeof a){case "function":return a;case "object":break;default:throw Error("Invalid schema - it must be an object or a constructor!");}return n(a)===p?Sb(a):Tb(a)}function Tb(a){function b(b){X.call(this,b);Nb(this,a)}fa(b,X);Ub(b,a);return b}function Sb(a){function b(a){Z.call(this,a,c)}a=a.$id;var c;switch(n(a)){case ga:c=a;break;case r:case p:c=Tb(a)}fa(b,Z);return b}
function Ub(a,b){for(var c in b){var d=b[c];switch(n(d)){case ha:case ia:case ja:void 0===a.prototype[c]?a.prototype[c]=Vb(c):na(c+" clashes with a built-in property or method. Use the generic .get("+c+") / .set("+c+", value) methods to access this property.");break;case ga:case r:case p:a.prototype[c+"Ctor_"]=Rb(d);void 0===a.prototype[c]?a.prototype[c]=Wb(c):na(c+" clashes with a built-in property or method. Use the generic .getModel("+c+") method to access this property.");break;default:throw new TypeError("Invalid property type for "+
c);}}}function Vb(a){return function(b){return 0===arguments.length?this.v(a):this.w(a,b)}}function Wb(a){return function(){return this.v(a)}};m("onfire.defineModel",Rb);la&&(module.exports=e.onfire);})();//# sourceMappingURL=./onfire.min.js.map
