(function(){var f = this;
function aa() {
}
function ba(a) {
  var b = typeof a;
  if ("object" == b) {
    if (a) {
      if (a instanceof Array) {
        return "array";
      }
      if (a instanceof Object) {
        return b;
      }
      var c = Object.prototype.toString.call(a);
      if ("[object Window]" == c) {
        return "object";
      }
      if ("[object Array]" == c || "number" == typeof a.length && "undefined" != typeof a.splice && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("splice")) {
        return "array";
      }
      if ("[object Function]" == c || "undefined" != typeof a.call && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("call")) {
        return "function";
      }
    } else {
      return "null";
    }
  } else {
    if ("function" == b && "undefined" == typeof a.call) {
      return "object";
    }
  }
  return b;
}
function h(a) {
  return "function" == ba(a);
}
function ca(a, b, c) {
  return a.call.apply(a.bind, arguments);
}
function da(a, b, c) {
  if (!a) {
    throw Error();
  }
  if (2 < arguments.length) {
    var d = Array.prototype.slice.call(arguments, 2);
    return function() {
      var c = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(c, d);
      return a.apply(b, c);
    };
  }
  return function() {
    return a.apply(b, arguments);
  };
}
function l(a, b, c) {
  l = Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? ca : da;
  return l.apply(null, arguments);
}
function ea(a, b) {
  var c = Array.prototype.slice.call(arguments, 1);
  return function() {
    var b = c.slice();
    b.push.apply(b, arguments);
    return a.apply(this, b);
  };
}
function m(a, b) {
  var c = a.split("."), d = f;
  c[0] in d || !d.execScript || d.execScript("var " + c[0]);
  for (var e;c.length && (e = c.shift());) {
    c.length || void 0 === b ? d[e] ? d = d[e] : d = d[e] = {} : d[e] = b;
  }
}
function n(a, b) {
  function c() {
  }
  c.prototype = b.prototype;
  a.P = b.prototype;
  a.prototype = new c;
  a.prototype.constructor = a;
  a.O = function(a, c, k) {
    for (var g = Array(arguments.length - 2), q = 2;q < arguments.length;q++) {
      g[q - 2] = arguments[q];
    }
    return b.prototype[c].apply(a, g);
  };
}
;function p(a) {
  switch(typeof a) {
    case "function":
      return fa;
    case "object":
      return void 0 !== a.$id ? r : u;
  }
  switch(a) {
    case "string":
      return ga;
    case "number":
      return ha;
    case "boolean":
      return ia;
    default:
      return ja;
  }
}
var ga = 0, ha = 1, ia = 2, u = 3, r = 4, fa = 5, ja = -1;
var ka = "undefined" !== typeof module && !!module.exports;
function v(a) {
  la("info", arguments);
}
function ma(a) {
  la("warn", arguments);
}
function w(a) {
  la("error", arguments);
}
function la(a, b) {
  var c = Array.prototype.slice.call(b, 0);
  c.unshift("ONFIRE:");
  "function" === typeof console[a] ? console[a].apply(console, c) : console.log.apply(console, c);
}
;function na(a, b) {
  this.c = a;
  this.f = b;
  this.b = 0;
  this.a = null;
}
function oa(a) {
  var b;
  0 < a.b ? (a.b--, b = a.a, a.a = b.next, b.next = null) : b = a.c();
  return b;
}
function pa(a, b) {
  a.f(b);
  100 > a.b && (a.b++, b.next = a.a, a.a = b);
}
;function qa(a) {
  var b = [], c = 0, d;
  for (d in a) {
    b[c++] = d;
  }
  return b;
}
;var ra = Array.prototype;
function sa(a) {
  return ra.concat.apply(ra, arguments);
}
;function ta() {
  this.b = this.a = null;
}
var va = new na(function() {
  return new ua;
}, function(a) {
  a.reset();
});
function wa() {
  var a = xa, b = null;
  a.a && (b = a.a, a.a = a.a.next, a.a || (a.b = null), b.next = null);
  return b;
}
function ua() {
  this.next = this.b = this.a = null;
}
ua.prototype.reset = function() {
  this.next = this.b = this.a = null;
};
var x;
a: {
  var ya = f.navigator;
  if (ya) {
    var za = ya.userAgent;
    if (za) {
      x = za;
      break a;
    }
  }
  x = "";
}
function y(a) {
  return -1 != x.indexOf(a);
}
;function Aa() {
  return y("Edge") || y("Trident") || y("MSIE");
}
;function Ba(a) {
  f.setTimeout(function() {
    throw a;
  }, 0);
}
var Ca;
function Da() {
  var a = f.MessageChannel;
  "undefined" === typeof a && "undefined" !== typeof window && window.postMessage && window.addEventListener && !y("Presto") && (a = function() {
    var a = document.createElement("IFRAME");
    a.style.display = "none";
    a.src = "";
    document.documentElement.appendChild(a);
    var b = a.contentWindow, a = b.document;
    a.open();
    a.write("");
    a.close();
    var c = "callImmediate" + Math.random(), d = "file:" == b.location.protocol ? "*" : b.location.protocol + "//" + b.location.host, a = l(function(a) {
      if (("*" == d || a.origin == d) && a.data == c) {
        this.port1.onmessage();
      }
    }, this);
    b.addEventListener("message", a, !1);
    this.port1 = {};
    this.port2 = {postMessage:function() {
      b.postMessage(c, d);
    }};
  });
  if ("undefined" !== typeof a && !Aa()) {
    var b = new a, c = {}, d = c;
    b.port1.onmessage = function() {
      if (void 0 !== c.next) {
        c = c.next;
        var a = c.L;
        c.L = null;
        a();
      }
    };
    return function(a) {
      d.next = {L:a};
      d = d.next;
      b.port2.postMessage(0);
    };
  }
  return "undefined" !== typeof document && "onreadystatechange" in document.createElement("SCRIPT") ? function(a) {
    var b = document.createElement("SCRIPT");
    b.onreadystatechange = function() {
      b.onreadystatechange = null;
      b.parentNode.removeChild(b);
      b = null;
      a();
      a = null;
    };
    document.documentElement.appendChild(b);
  } : function(a) {
    f.setTimeout(a, 0);
  };
}
;function z(a, b) {
  this.b = {};
  this.a = [];
  this.f = this.c = 0;
  var c = arguments.length;
  if (1 < c) {
    if (c % 2) {
      throw Error("Uneven number of arguments");
    }
    for (var d = 0;d < c;d += 2) {
      A(this, arguments[d], arguments[d + 1]);
    }
  } else {
    if (a) {
      if (a instanceof z) {
        c = a.s(), d = a.u();
      } else {
        var c = qa(a), e = [], k = 0;
        for (d in a) {
          e[k++] = a[d];
        }
        d = e;
      }
      for (e = 0;e < c.length;e++) {
        A(this, c[e], d[e]);
      }
    }
  }
}
z.prototype.u = function() {
  Ea(this);
  for (var a = [], b = 0;b < this.a.length;b++) {
    a.push(this.b[this.a[b]]);
  }
  return a;
};
z.prototype.s = function() {
  Ea(this);
  return this.a.concat();
};
z.prototype.clear = function() {
  this.b = {};
  this.f = this.c = this.a.length = 0;
};
function Ea(a) {
  if (a.c != a.a.length) {
    for (var b = 0, c = 0;b < a.a.length;) {
      var d = a.a[b];
      B(a.b, d) && (a.a[c++] = d);
      b++;
    }
    a.a.length = c;
  }
  if (a.c != a.a.length) {
    for (var e = {}, c = b = 0;b < a.a.length;) {
      d = a.a[b], B(e, d) || (a.a[c++] = d, e[d] = 1), b++;
    }
    a.a.length = c;
  }
}
function C(a, b) {
  return B(a.b, b) ? a.b[b] : void 0;
}
function A(a, b, c) {
  B(a.b, b) || (a.c++, a.a.push(b), a.f++);
  a.b[b] = c;
}
z.prototype.forEach = function(a, b) {
  for (var c = this.s(), d = 0;d < c.length;d++) {
    var e = c[d];
    a.call(b, C(this, e), e, this);
  }
};
z.prototype.clone = function() {
  return new z(this);
};
function B(a, b) {
  return Object.prototype.hasOwnProperty.call(a, b);
}
;function Ga(a, b) {
  D || Ha();
  E || (D(), E = !0);
  var c = xa, d = oa(va);
  d.a = a;
  d.b = b;
  d.next = null;
  c.b ? c.b.next = d : c.a = d;
  c.b = d;
}
var D;
function Ha() {
  if (f.Promise && f.Promise.resolve) {
    var a = f.Promise.resolve();
    D = function() {
      a.then(Ia);
    };
  } else {
    D = function() {
      var a = Ia;
      !h(f.setImmediate) || f.Window && f.Window.prototype && f.Window.prototype.setImmediate == f.setImmediate ? (Ca || (Ca = Da()), Ca(a)) : f.setImmediate(a);
    };
  }
}
var E = !1, xa = new ta;
[].push(function() {
  E = !1;
  xa = new ta;
});
function Ia() {
  for (var a = null;a = wa();) {
    try {
      a.a.call(a.b);
    } catch (b) {
      Ba(b);
    }
    pa(va, a);
  }
  E = !1;
}
;function F(a, b) {
  this.a = G;
  this.i = void 0;
  this.c = this.b = this.g = null;
  this.f = this.h = !1;
  if (a == Ja) {
    H(this, J, b);
  } else {
    try {
      var c = this;
      a.call(b, function(a) {
        H(c, J, a);
      }, function(a) {
        try {
          if (a instanceof Error) {
            throw a;
          }
          throw Error("Promise rejected.");
        } catch (b) {
        }
        H(c, K, a);
      });
    } catch (d) {
      H(this, K, d);
    }
  }
}
var G = 0, J = 2, K = 3;
function Ka() {
  this.next = this.c = this.b = this.f = this.a = null;
  this.g = !1;
}
Ka.prototype.reset = function() {
  this.c = this.b = this.f = this.a = null;
  this.g = !1;
};
var Ma = new na(function() {
  return new Ka;
}, function(a) {
  a.reset();
});
function Na(a, b, c) {
  var d = oa(Ma);
  d.f = a;
  d.b = b;
  d.c = c;
  return d;
}
function Ja() {
}
function Oa(a) {
  return new F(function(b, c) {
    c(a);
  });
}
function Pa(a) {
  return new F(function(b, c) {
    var d = a.length, e = [];
    if (d) {
      for (var k = function(a, c) {
        d--;
        e[a] = c;
        0 == d && b(e);
      }, g = function(a) {
        c(a);
      }, q = 0, t;t = a[q];q++) {
        Qa(t, ea(k, q), g);
      }
    } else {
      b(e);
    }
  });
}
F.prototype.then = function(a, b, c) {
  return Ra(this, h(a) ? a : null, h(b) ? b : null, c);
};
F.prototype.then = F.prototype.then;
F.prototype.$goog_Thenable = !0;
function Qa(a, b, c, d) {
  a instanceof F ? Sa(a, Na(b || aa, c || null, d)) : a.then(b, c, d);
}
function Sa(a, b) {
  a.b || a.a != J && a.a != K || Ta(a);
  a.c ? a.c.next = b : a.b = b;
  a.c = b;
}
function Ra(a, b, c, d) {
  var e = Na(null, null, null);
  e.a = new F(function(a, g) {
    e.f = b ? function(c) {
      try {
        var e = b.call(d, c);
        a(e);
      } catch (I) {
        g(I);
      }
    } : a;
    e.b = c ? function(b) {
      try {
        var e = c.call(d, b);
        a(e);
      } catch (I) {
        g(I);
      }
    } : g;
  });
  e.a.g = a;
  Sa(a, e);
  return e.a;
}
F.prototype.j = function(a) {
  this.a = G;
  H(this, J, a);
};
F.prototype.l = function(a) {
  this.a = G;
  H(this, K, a);
};
function H(a, b, c) {
  if (a.a == G) {
    if (a == c) {
      b = K, c = new TypeError("Promise cannot resolve to itself");
    } else {
      var d;
      if (c) {
        try {
          d = !!c.$goog_Thenable;
        } catch (e) {
          d = !1;
        }
      } else {
        d = !1;
      }
      if (d) {
        a.a = 1;
        Qa(c, a.j, a.l, a);
        return;
      }
      d = typeof c;
      if ("object" == d && null != c || "function" == d) {
        try {
          var k = c.then;
          if (h(k)) {
            Ua(a, c, k);
            return;
          }
        } catch (g) {
          b = K, c = g;
        }
      }
    }
    a.i = c;
    a.a = b;
    a.g = null;
    Ta(a);
    b != K || Va(a, c);
  }
}
function Ua(a, b, c) {
  function d(b) {
    k || (k = !0, a.l(b));
  }
  function e(b) {
    k || (k = !0, a.j(b));
  }
  a.a = 1;
  var k = !1;
  try {
    c.call(b, e, d);
  } catch (g) {
    d(g);
  }
}
function Ta(a) {
  a.h || (a.h = !0, Ga(a.m, a));
}
function Wa(a) {
  var b = null;
  a.b && (b = a.b, a.b = b.next, b.next = null);
  a.b || (a.c = null);
  return b;
}
F.prototype.m = function() {
  for (var a = null;a = Wa(this);) {
    var b = this.a, c = this.i;
    if (b == K && a.b && !a.g) {
      for (var d = void 0, d = this;d && d.f;d = d.g) {
        d.f = !1;
      }
    }
    if (a.a) {
      a.a.g = null, Xa(a, b, c);
    } else {
      try {
        a.g ? a.f.call(a.c) : Xa(a, b, c);
      } catch (e) {
        Ya.call(null, e);
      }
    }
    pa(Ma, a);
  }
  this.h = !1;
};
function Xa(a, b, c) {
  b == J ? a.f.call(a.c, c) : a.b && a.b.call(a.c, c);
}
function Va(a, b) {
  a.f = !0;
  Ga(function() {
    a.f && Ya.call(null, b);
  });
}
var Ya = Ba;
var L = "undefined" !== typeof Promise;
function M(a) {
  return L ? new Promise(a) : new F(a);
}
function N(a) {
  return L ? Promise.all(a) : Pa(a);
}
;function Za(a, b) {
  return M(function(c, d) {
    if (void 0 !== b) {
      var e = a.push(b, function(a) {
        a ? d(a) : c(e);
      })
    } else {
      c(a.push());
    }
  });
}
function $a(a, b) {
  return M(function(c, d) {
    a.set(b, function(a) {
      a ? d(a) : c();
    });
  });
}
function ab(a, b) {
  return M(function(c, d) {
    a.update(b, function(a) {
      a ? d(a) : c();
    });
  });
}
function bb(a, b) {
  return M(function(c, d) {
    a.transaction(b, function(a, b, g) {
      a ? d(a) : c({isCommitted:b, snapshot:g});
    }, !1);
  });
}
function cb(a) {
  return M(function(b, c) {
    a.remove(function(a) {
      a ? c(a) : b();
    });
  });
}
function db(a, b) {
  return M(function(c, d) {
    a.once(b, function(a) {
      c(a);
    }, function(a) {
      d(a);
    });
  });
}
ka && require("firebase");
function O() {
  this.a = [];
}
O.b = function() {
  return O.a ? O.a : O.a = new O;
};
function P(a, b, c, d) {
  a: {
    var e = O.b();
    if (null === a) {
      b = [null], b = L ? Promise.resolve(b) : b instanceof F ? b : new F(Ja, b);
    } else {
      v("LOCAL_TRIGGER_GENERATED " + b.toUpperCase() + " at " + a.a());
      var k = [];
      a = a.a();
      for (var g = 0;g < e.a.length;g++) {
        var q = e.a[g][0], t = e.a[g][1], I = e.a[g][2], Fa = e.a[g][3];
        if (t === b) {
          var X = a.match(q);
          if (X) {
            v("LOCAL_TRIGGER_MATCHED at " + q.toString() + " on " + t.toUpperCase() + " for " + Fa.id());
            X.push(c);
            "value" === b && X.push(d);
            try {
              var rb = I.apply(Fa, X.slice(1));
            } catch (La) {
              v("LOCAL_TRIGGER_FAILED at " + q.toString() + " on " + t.toUpperCase(), La);
              b = La;
              b = L ? Promise.reject(b) : Oa(b);
              break a;
            }
            k.push(rb);
          }
        }
      }
      b = N(k);
    }
  }
  return b;
}
function eb(a, b) {
  return P(a, "child_added", b);
}
;var fb = y("Opera") || y("OPR"), gb = Aa(), hb = y("Gecko") && !(-1 != x.toLowerCase().indexOf("webkit") && !y("Edge")) && !(y("Trident") || y("MSIE")) && !y("Edge"), ib = -1 != x.toLowerCase().indexOf("webkit") && !y("Edge");
function jb() {
  var a = x;
  if (hb) {
    return /rv\:([^\);]+)(\)|;)/.exec(a);
  }
  if (gb && y("Edge")) {
    return /Edge\/([\d\.]+)/.exec(a);
  }
  if (gb) {
    return /\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);
  }
  if (ib) {
    return /WebKit\/(\S+)/.exec(a);
  }
}
(function() {
  if (fb && f.opera) {
    var a = f.opera.version;
    return h(a) ? a() : a;
  }
  var a = "", b = jb();
  b && (a = b ? b[1] : "");
  return gb && !y("Edge") && (b = (b = f.document) ? b.documentMode : void 0, b > parseFloat(a)) ? String(b) : a;
})();
var kb = /^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
function lb(a) {
  if (mb) {
    mb = !1;
    var b = f.location;
    if (b) {
      var c = b.href;
      if (c && (c = (c = lb(c)[3] || null) ? decodeURI(c) : c) && c != b.hostname) {
        throw mb = !0, Error();
      }
    }
  }
  return a.match(kb);
}
var mb = ib;
function nb(a, b) {
  for (var c = a.split("&"), d = 0;d < c.length;d++) {
    var e = c[d].indexOf("="), k = null, g = null;
    0 <= e ? (k = c[d].substring(0, e), g = c[d].substring(e + 1)) : k = c[d];
    b(k, g ? decodeURIComponent(g.replace(/\+/g, " ")) : "");
  }
}
;function Q(a, b) {
  this.f = this.j = this.b = "";
  this.i = null;
  this.h = this.c = "";
  this.a = !1;
  var c;
  a instanceof Q ? (this.a = void 0 !== b ? b : a.a, ob(this, a.b), this.j = a.j, this.f = a.f, pb(this, a.i), this.c = a.c, qb(this, a.g.clone()), this.h = a.h) : a && (c = lb(String(a))) ? (this.a = !!b, ob(this, c[1] || "", !0), this.j = R(c[2] || ""), this.f = R(c[3] || "", !0), pb(this, c[4]), this.c = R(c[5] || "", !0), qb(this, c[6] || "", !0), this.h = R(c[7] || "")) : (this.a = !!b, this.g = new S(null, 0, this.a));
}
Q.prototype.toString = function() {
  var a = [], b = this.b;
  b && a.push(T(b, sb, !0), ":");
  if (b = this.f) {
    a.push("//");
    var c = this.j;
    c && a.push(T(c, sb, !0), "@");
    a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g, "%$1"));
    b = this.i;
    null != b && a.push(":", String(b));
  }
  if (b = this.c) {
    this.f && "/" != b.charAt(0) && a.push("/"), a.push(T(b, "/" == b.charAt(0) ? tb : ub, !0));
  }
  (b = this.g.toString()) && a.push("?", b);
  (b = this.h) && a.push("#", T(b, vb));
  return a.join("");
};
Q.prototype.clone = function() {
  return new Q(this);
};
function ob(a, b, c) {
  a.b = c ? R(b, !0) : b;
  a.b && (a.b = a.b.replace(/:$/, ""));
}
function pb(a, b) {
  if (b) {
    b = Number(b);
    if (isNaN(b) || 0 > b) {
      throw Error("Bad port number " + b);
    }
    a.i = b;
  } else {
    a.i = null;
  }
}
function qb(a, b, c) {
  b instanceof S ? (a.g = b, wb(a.g, a.a)) : (c || (b = T(b, xb)), a.g = new S(b, 0, a.a));
}
function R(a, b) {
  return a ? b ? decodeURI(a.replace(/%25/g, "%2525")) : decodeURIComponent(a) : "";
}
function T(a, b, c) {
  return "string" == typeof a ? (a = encodeURI(a).replace(b, yb), c && (a = a.replace(/%25([0-9a-fA-F]{2})/g, "%$1")), a) : null;
}
function yb(a) {
  a = a.charCodeAt(0);
  return "%" + (a >> 4 & 15).toString(16) + (a & 15).toString(16);
}
var sb = /[#\/\?@]/g, ub = /[\#\?:]/g, tb = /[\#\?]/g, xb = /[\#\?@]/g, vb = /#/g;
function S(a, b, c) {
  this.c = this.a = null;
  this.b = a || null;
  this.f = !!c;
}
function U(a) {
  a.a || (a.a = new z, a.c = 0, a.b && nb(a.b, function(b, c) {
    var d = decodeURIComponent(b.replace(/\+/g, " "));
    U(a);
    a.b = null;
    var d = V(a, d), e = C(a.a, d);
    e || A(a.a, d, e = []);
    e.push(c);
    a.c++;
  }));
}
function zb(a, b) {
  U(a);
  b = V(a, b);
  if (B(a.a.b, b)) {
    a.b = null;
    a.c -= C(a.a, b).length;
    var c = a.a;
    B(c.b, b) && (delete c.b[b], c.c--, c.f++, c.a.length > 2 * c.c && Ea(c));
  }
}
S.prototype.clear = function() {
  this.a = this.b = null;
  this.c = 0;
};
S.prototype.s = function() {
  U(this);
  for (var a = this.a.u(), b = this.a.s(), c = [], d = 0;d < b.length;d++) {
    for (var e = a[d], k = 0;k < e.length;k++) {
      c.push(b[d]);
    }
  }
  return c;
};
S.prototype.u = function(a) {
  U(this);
  var b = [];
  if ("string" == typeof a) {
    var c = a;
    U(this);
    c = V(this, c);
    B(this.a.b, c) && (b = sa(b, C(this.a, V(this, a))));
  } else {
    for (a = this.a.u(), c = 0;c < a.length;c++) {
      b = sa(b, a[c]);
    }
  }
  return b;
};
S.prototype.toString = function() {
  if (this.b) {
    return this.b;
  }
  if (!this.a) {
    return "";
  }
  for (var a = [], b = this.a.s(), c = 0;c < b.length;c++) {
    for (var d = b[c], e = encodeURIComponent(String(d)), d = this.u(d), k = 0;k < d.length;k++) {
      var g = e;
      "" !== d[k] && (g += "=" + encodeURIComponent(String(d[k])));
      a.push(g);
    }
  }
  return this.b = a.join("&");
};
S.prototype.clone = function() {
  var a = new S;
  a.b = this.b;
  this.a && (a.a = this.a.clone(), a.c = this.c);
  return a;
};
function V(a, b) {
  var c = String(b);
  a.f && (c = c.toLowerCase());
  return c;
}
function wb(a, b) {
  b && !a.f && (U(a), a.b = null, a.a.forEach(function(a, b) {
    var e = b.toLowerCase();
    if (b != e && (zb(this, b), zb(this, e), 0 < a.length)) {
      this.b = null;
      var k = this.a, e = V(this, e), g;
      g = a.length;
      if (0 < g) {
        for (var q = Array(g), t = 0;t < g;t++) {
          q[t] = a[t];
        }
        g = q;
      } else {
        g = [];
      }
      A(k, e, g);
      this.c += a.length;
    }
  }, a));
  a.f = b;
}
;function W(a) {
  this.b = a;
}
m("onfire.Ref", W);
W.prototype.f = function(a, b) {
  var c = this.b.child(a);
  return new W(null != b ? c.child(b) : c);
};
W.prototype.child = W.prototype.f;
W.prototype.F = function() {
  return new W(this.b.root());
};
W.prototype.root = W.prototype.F;
W.prototype.push = function(a) {
  v("PUSH " + this.a() + " :", a);
  var b = this;
  return Za(this.b, a).then(function(c) {
    v("PUSH (Success) " + b.a() + " :", a);
    return new W(c);
  }, function(c) {
    w("PUSH (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
W.prototype.push = W.prototype.push;
W.prototype.i = function() {
  return this.b.push().key();
};
W.prototype.generateId = W.prototype.i;
W.prototype.G = function(a) {
  v("SET " + this.a() + " :", a);
  var b = this;
  return $a(this.b, a).then(function() {
    v("SET (Success) " + b.a() + " :", a);
    return null;
  }, function(c) {
    w("SET (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
W.prototype.set = W.prototype.G;
W.prototype.B = function(a) {
  v("UPDATE " + this.a() + " :", a);
  var b = this;
  return ab(this.b, a).then(function() {
    v("UPDATE (Success) " + b.a() + " :", a);
    return null;
  }, function(c) {
    w("UPDATE (Failure) " + b.a() + " :", a, c);
    throw c;
  });
};
W.prototype.update = W.prototype.B;
W.prototype.A = function(a) {
  v("TRANSACTION at " + this.a());
  var b = this;
  return bb(this.b, a).then(function(a) {
    v("TRANSACTION " + (a.isCommitted ? "Committed" : "Not Committed") + " at " + b.a() + " :", a.snapshot.val());
    return a;
  }, function(a) {
    w("TRANSACTION Failed at " + b.a());
    throw a;
  });
};
W.prototype.transaction = W.prototype.A;
W.prototype.D = function() {
  v("REMOVE " + this.a());
  var a = this;
  return cb(this.b).then(function() {
    v("REMOVE (Success) " + a.a());
    return null;
  }, function(b) {
    w("REMOVE (Failure) " + a.a(), b);
    throw b;
  });
};
W.prototype.remove = W.prototype.D;
W.prototype.v = function(a) {
  v("ONCE " + a.toUpperCase() + " " + this.a());
  var b = this;
  return db(this.b, a).then(function(c) {
    v("ONCE " + a.toUpperCase() + " (Success) " + b.a(), c.val());
    return c;
  }, function(c) {
    w("ONCE " + a.toUpperCase() + " (Failure) " + b.a(), c);
    throw c;
  });
};
W.prototype.once = W.prototype.v;
W.prototype.K = function() {
  return this.v("value").then(function(a) {
    return a.val();
  });
};
W.prototype.onceValue = W.prototype.K;
W.prototype.m = function(a, b, c, d) {
  var e = this;
  return this.b.on(a, function(c, g) {
    v(a.toUpperCase() + " at " + e.a(), c.val());
    b.call(d, c, g);
  }, function(b) {
    w(a.toUpperCase() + " CANCELLED at " + e.a(), b);
    "function" === typeof c && c.call(d, b);
  });
};
W.prototype.on = W.prototype.m;
W.prototype.h = function(a, b, c) {
  this.b.off(a, b, c);
};
W.prototype.off = W.prototype.h;
W.prototype.j = function(a, b, c) {
  return this.m("value", function(b) {
    a.call(c, b.val());
  }, b, c);
};
W.prototype.onValue = W.prototype.j;
W.prototype.J = function(a, b) {
  this.h("value", a, b);
};
W.prototype.offValue = W.prototype.J;
W.prototype.C = function() {
  return this.b;
};
W.prototype.ref = W.prototype.C;
W.prototype.g = function() {
  var a = this.b.parent();
  return a ? new W(a) : null;
};
W.prototype.parent = W.prototype.g;
W.prototype.l = function() {
  return this.b.key();
};
W.prototype.key = W.prototype.l;
W.prototype.a = function() {
  var a;
  if (!(a = this.c)) {
    a = decodeURIComponent;
    var b = this.b.toString(), b = (b instanceof Q ? b.clone() : new Q(b, void 0)).c;
    a = this.c = a(b) || "/";
  }
  return a;
};
W.prototype.path = W.prototype.a;
function Y(a) {
  if (!(a instanceof W)) {
    throw Error("ref argument must be an onfire.Ref instance");
  }
  this.a = a;
  this.H = {};
  this.w = !1;
  this.b = 0;
  this.h = null;
  this.j = [];
  this.o = Ab(this);
}
m("onfire.model.Model", Y);
Y.prototype.I = function() {
  v("DISPOSE  " + this.a.a() + " ...");
  this.v();
  delete this.o;
  this.a.h(void 0, void 0, this);
  for (var a = 0;a < this.j.length;a++) {
    this.j[a].I();
  }
  v("DISPOSED " + this.a.a());
};
Y.prototype.dispose = Y.prototype.I;
function Bb(a, b) {
  a.h = b;
  var c = [], d;
  for (d in a.h) {
    var e;
    switch(p(a.h[d])) {
      case ga:
      ;
      case ha:
      ;
      case ia:
        break;
      case u:
      ;
      case r:
        e = a[d + "Ctor_"];
        a[d + "Inst_"] = new e(a.a.f(d));
        c.push(a[d + "Inst_"].o);
        a.j.push(a[d + "Inst_"]);
        break;
      default:
        throw new TypeError("Invalid property type for " + d);;
    }
  }
  a.o = a.o.then(function() {
    return N(c);
  }).then(function() {
    return a;
  });
}
function Ab(a) {
  return M(function(b) {
    var c = !1;
    a.a.j(function(d) {
      a.f = d;
      a.b = qa(d).length;
      c || (b(a), c = !0);
    }, void 0);
  });
}
Y.prototype.N = function() {
  return this.o;
};
Y.prototype.whenLoaded = Y.prototype.N;
Y.prototype.v = function() {
  return this.a.l();
};
Y.prototype.key = Y.prototype.v;
Y.prototype.G = function() {
  return !!this.f;
};
Y.prototype.exists = Y.prototype.G;
Y.prototype.g = function(a) {
  return this.m(a) || this.l(a);
};
Y.prototype.get = Y.prototype.g;
Y.prototype.l = function(a) {
  return this.f ? this.f[a] : null;
};
Y.prototype.getBasicValue = Y.prototype.l;
Y.prototype.m = function(a) {
  return this[a + "Inst_"];
};
Y.prototype.getModel = Y.prototype.m;
Y.prototype.i = function(a, b) {
  this.H[a] = b;
  this.w = !0;
  return this;
};
Y.prototype.set = Y.prototype.i;
Y.prototype.M = function() {
  return this.w ? Cb(this, this.H).then(function(a) {
    a.H = {};
    a.w = !1;
    return a;
  }) : L ? Promise.resolve(this) : this instanceof F ? this : new F(Ja, this);
};
Y.prototype.save = Y.prototype.M;
Y.prototype.J = function() {
  return this.w;
};
Y.prototype.hasChanges = Y.prototype.J;
function Cb(a, b) {
  var c = a.b, d = {}, e;
  for (e in b) {
    d[e] = a.g(e);
  }
  return a.a.B(b).then(function() {
    var c = [];
    for (e in b) {
      if (d[e] !== b[e]) {
        var g = P(a.a.f(e), "value", d[e], b[e]);
        c.push(g);
      }
    }
    return N(c);
  }).then(function() {
    if (0 < c && 0 === a.b) {
      v("REMOVED " + a.a.a());
      var b = a.a.g();
      return P(b, "child_removed", a);
    }
    if (0 === c && 0 < a.b) {
      return v("CREATED " + a.a.a()), eb(a.a.g(), a);
    }
  }).then(function() {
    return a;
  });
}
function Db(a, b) {
  return a.a.A(function(a) {
    if (null === a) {
      return b;
    }
  }).then(function(b) {
    return b.isCommitted ? (v("CREATED " + a.a.a()), eb(a.a.g(), a).then(function() {
      return b;
    })) : b;
  });
}
;function Z(a, b) {
  Y.call(this, a);
  this.C = b || Y;
}
n(Z, Y);
m("onfire.model.Collection", Z);
Z.prototype.c = function(a) {
  return (new this.C(this.a.f(a))).o;
};
Z.prototype.fetchItem = Z.prototype.c;
Z.prototype.A = function(a) {
  var b = this.a.i(), b = this.c(b);
  a && (b = b.then(function(b) {
    return Cb(b, a);
  }));
  return b;
};
Z.prototype.createItem = Z.prototype.A;
Z.prototype.B = function(a, b) {
  return this.c(a).then(function(a) {
    return b ? Db(a, b).then(function() {
      return a;
    }) : a;
  });
};
Z.prototype.fetchOrCreateItem = Z.prototype.B;
Z.prototype.F = function(a) {
  var b, c = this;
  return this.c(a).then(function(a) {
    b = a;
  }).then(function() {
    return c.i(a, null);
  }).then(function() {
    return P(c.a, "child_removed", b);
  }).then(function() {
    b.I();
  });
};
Z.prototype.removeItem = Z.prototype.F;
Z.prototype.forEach = function(a) {
  var b = [], c;
  for (c in this.f) {
    var d = this.c(c).then(function(b) {
      return a.call(null, b, c);
    });
    b.push(d);
  }
  return N(b);
};
Z.prototype.forEach = Z.prototype.forEach;
Z.prototype.D = function() {
  return this.b;
};
Z.prototype.count = Z.prototype.D;
Z.prototype.K = function() {
  return qa(this.f);
};
Z.prototype.ids = Z.prototype.K;
function Eb(a) {
  switch(typeof a) {
    case "function":
      return a;
    case "object":
      break;
    default:
      throw Error("Invalid config - it must be an object or a constructor!");;
  }
  return p(a) === r ? Fb(a) : Gb(a);
}
function Gb(a) {
  function b(b) {
    Y.call(this, b);
    Bb(this, a);
  }
  n(b, Y);
  Hb(b, a);
  return b;
}
function Fb(a) {
  function b(a) {
    Z.call(this, a, c);
  }
  a = a.$id;
  var c;
  switch(p(a)) {
    case fa:
      c = a;
      break;
    case u:
    ;
    case r:
      c = Gb(a);
  }
  n(b, Z);
  return b;
}
function Hb(a, b) {
  for (var c in b) {
    var d = b[c];
    switch(p(d)) {
      case ga:
      ;
      case ha:
      ;
      case ia:
        void 0 === a.prototype[c] ? a.prototype[c] = Ib(c) : ma(c + " clashes with a built-in property or method. Use the generic .get(" + c + ") / .set(" + c + ", value) methods to access this property.");
        break;
      case fa:
      ;
      case u:
      ;
      case r:
        a.prototype[c + "Ctor_"] = Eb(d);
        void 0 === a.prototype[c] ? a.prototype[c] = Jb(c) : ma(c + " clashes with a built-in property or method. Use the generic .getModel(" + c + ") method to access this property.");
        break;
      default:
        throw new TypeError("Invalid property type for " + c);;
    }
  }
}
function Ib(a) {
  return function(b) {
    return 0 === arguments.length ? this.g(a) : this.i(a, b);
  };
}
function Jb(a) {
  return function() {
    return this.g(a);
  };
}
;m("onfire.generateConstructor", Eb);
ka && (module.exports = f.onfire);
})();//# sourceMappingURL=./onfire.min.js.map
